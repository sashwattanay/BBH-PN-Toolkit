(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    115506,       3205]
NotebookOptionsPosition[    110663,       3114]
NotebookOutlinePosition[    111136,       3132]
CellTagsIndexPosition[    111093,       3129]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Derivation of L vector: coordinate method  (Eq. 3.28)", "Subsection",
 CellChangeTimes->{{3.8621055775655003`*^9, 3.862105596441474*^9}, {
  3.862108362650505*^9, 
  3.862108366488607*^9}},ExpressionUUID->"9b84d41c-29e1-42fd-b58e-\
c4db06445d14"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EulMatItoNI", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}], ",", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}], ",", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}]}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], ",", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}]}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], ",", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], "}"}]}], "}"}]}], "    ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LvecNI", " ", "=", " ", 
   RowBox[{"L", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S1vecNI", "=", 
   RowBox[{"S1", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Xi]3", "[", "t", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Xi]3", "[", "t", "]"}], "]"}]}], ",", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}]}], "}"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S2vecNI", "=", 
   RowBox[{"S2", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"\[Xi]3", "[", "t", "]"}], "+", 
         RowBox[{"\[CapitalDelta]\[Psi]", "[", "t", "]"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"\[Xi]3", "[", "t", "]"}], "+", 
         RowBox[{"\[CapitalDelta]\[Psi]", "[", "t", "]"}]}], "]"}]}], ",", 
      " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}]}], "}"}]}]}], "  ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SeffNI", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Delta]1", " ", "S1vecNI"}], "+", 
     RowBox[{"\[Delta]2", " ", "S2vecNI"}]}], ")"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rVecNI", " ", "=", " ", 
   RowBox[{
    RowBox[{"r", "[", "t", "]"}], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], ",", "0"}], "}"}]}]}], " ", 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Cos\[Kappa]2", " ", "=", " ", 
   RowBox[{"\[Sigma]2", " ", "-", " ", 
    RowBox[{
     FractionBox[
      RowBox[{"\[Delta]1", " ", "S1"}], 
      RowBox[{"\[Delta]2", " ", "S2"}]], " ", "Cos\[Kappa]1"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cos\[Gamma]", " ", "=", " ", 
   RowBox[{"\[Sigma]1", " ", "+", " ", 
    RowBox[{
     FractionBox["L", "S2"], 
     FractionBox[
      RowBox[{"(", 
       RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], "\[Delta]2"], " ", 
     "Cos\[Kappa]1"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.862071603426189*^9, 3.862071878609968*^9}, {
   3.862072531200912*^9, 3.86207259273916*^9}, {3.862072664529748*^9, 
   3.862072664851293*^9}, {3.8620727029783773`*^9, 3.86207275844269*^9}, {
   3.862073101660571*^9, 3.862073118489629*^9}, {3.862073276448357*^9, 
   3.8620732918244333`*^9}, 3.8620956605025387`*^9, 3.862095762537478*^9, 
   3.862095852981821*^9, {3.862095927125671*^9, 3.862095928299429*^9}, {
   3.86209599091327*^9, 3.8620959918168697`*^9}, 3.862096022142098*^9, {
   3.862096346041521*^9, 3.8620964040670147`*^9}, {3.862096556214464*^9, 
   3.8620965600807247`*^9}, 3.862103498143393*^9, 3.862103696295463*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"d00c22de-cfc1-492a-8ab8-b069738dc2f1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"JvecI", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "J"}], "}"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JvecNI", " ", "=", " ", 
   RowBox[{"EulMatItoNI", ".", "JvecI"}]}], "  ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "JvecNI", " ", "-", " ", "LvecNI", " ", "-", "S1vecNI", " ", "-", 
          "S2vecNI"}], ")"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "==", "0"}], " ", ",", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"\[CapitalDelta]\[Psi]", "[", "t", "]"}], "+", 
        RowBox[{"\[Xi]3", "[", "t", "]"}]}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "  ", ";", 
  RowBox[{"Cos\[Xi]2sol", " ", "=", " ", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "JvecNI", " ", "-", " ", "LvecNI", " ", "-", "S1vecNI", " ", "-", 
          "S2vecNI"}], ")"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "==", "0"}], " ", ",", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "  ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LdotVecNI", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"EulMatItoNI", ".", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Inverse", "[", "EulMatItoNI", "]"}], ".", "LvecNI"}], 
          "   ", "//", "Simplify"}], "  ", ",", "t"}], "]"}]}], ")"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "   ", "//", "Simplify"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LdotVecNI2", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Delta]1", " ", "S1vecNI"}], "+", 
          RowBox[{"\[Delta]2", " ", "S2vecNI"}]}], ")"}], ",", " ", 
        "LvecNI"}], " ", "]"}], "  ", "//", "Simplify"}], " ", ")"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sin\[Xi]3Sol", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"\[Xi]3", "[", "t", "]"}], "]"}], "->", "    ", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"S1", " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}], "2"]}], "  ", "+", 
        " ", 
        RowBox[{"S2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}], "   ", "-", " ", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], " ", 
       ")"}], 
      RowBox[{"J", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}]]}], " ", "}"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SubsList4", "=", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}], "->", "Cos\[Kappa]2"}], 
     ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Gamma]", "[", "t", "]"}], "]"}], " ", "->", "Cos\[Gamma]"}],
      " ", ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}], "->", "Cos\[Kappa]1"}]}], 
    "  ", "}"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{"var2", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Xi]1", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "/.", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{"LdotVecNI", " ", "==", 
              RowBox[{"(", " ", 
               RowBox[{"LdotVecNI2", "/.", "sol1"}], " ", ")"}]}], ",", "  ", 
             
             RowBox[{
              SuperscriptBox["\[Xi]1", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}]}], " ", "]"}], "  ", 
           ")"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "     ", "/.", "Sin\[Xi]3Sol"}], 
       " ", "/.", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Csc", "[", 
          RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}], "2"], "->", 
        FractionBox["1", 
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}], "2"]}]]}]}], " ", "/.", 
      "Cos\[Xi]2sol"}], "/.", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}], "2"], "->", 
      RowBox[{"1", "-", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}], "2"]}]}]}], " ", "/.", 
    "SubsList4"}], " ", "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.862083691255422*^9, 3.862083897125264*^9}, {
   3.8620841829158707`*^9, 3.8620842267529593`*^9}, {3.862084264909082*^9, 
   3.862084281271883*^9}, {3.862084551256525*^9, 3.8620846167321444`*^9}, {
   3.862084654760751*^9, 3.862084663341976*^9}, {3.8620848155687017`*^9, 
   3.8620848279551687`*^9}, {3.862084921992732*^9, 3.8620852081144047`*^9}, {
   3.86208526467522*^9, 3.862085383165073*^9}, {3.86208557550423*^9, 
   3.862085616712676*^9}, {3.8620856596121473`*^9, 3.8620858402679033`*^9}, {
   3.8620859496809464`*^9, 3.862086198199656*^9}, {3.862086232628152*^9, 
   3.86208624856884*^9}, {3.8620879159141273`*^9, 3.86208792749573*^9}, {
   3.8620879821798077`*^9, 3.862087983191799*^9}, {3.862095792270812*^9, 
   3.862095804986672*^9}, {3.862095866452489*^9, 3.862095866772489*^9}, 
   3.8620960336197777`*^9, {3.862103606467577*^9, 3.8621036612837973`*^9}, {
   3.862103713518765*^9, 3.862103751944936*^9}, {3.862103820778503*^9, 
   3.862103923638219*^9}, {3.862103963162674*^9, 3.862104058705241*^9}, {
   3.8621041288373013`*^9, 3.862104295624107*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"d7032432-7e05-4db2-91a3-2c97b114b295"],

Cell[BoxData[
 FractionBox[
  RowBox[{"J", " ", "\[Delta]2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Cos\[Kappa]1", " ", "S1", " ", 
      RowBox[{"(", 
       RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"L", " ", 
         RowBox[{"(", 
          RowBox[{"\[Delta]1", "+", "\[Delta]2"}], ")"}]}], "+", 
        RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}]}], "-", 
     RowBox[{"\[Delta]2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["S1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "\[Delta]1"}], "+", "\[Delta]2"}], ")"}]}], "+", 
        RowBox[{"S1", " ", "S2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "\[Delta]1"}], "+", "\[Delta]2"}], ")"}], " ", 
         "\[Sigma]1"}], "+", 
        RowBox[{"\[Delta]2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["J", "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"L", "+", 
              RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}], "2"]}], ")"}]}]}], 
       ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["Cos\[Kappa]1", "2"]}], " ", 
    SuperscriptBox["S1", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], "2"]}], "+", 
   RowBox[{"2", " ", "Cos\[Kappa]1", " ", "S1", " ", 
    RowBox[{"(", 
     RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], " ", "\[Delta]2", " ", 
    RowBox[{"(", 
     RowBox[{"L", "+", 
      RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["\[Delta]2", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["J", "2"], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"L", "+", 
         RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}], "2"]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.862085182666836*^9, 3.862085208522943*^9}, {
   3.862085580390975*^9, 3.862085617039576*^9}, 3.862085738888659*^9, 
   3.8620858187179403`*^9, {3.862086112609373*^9, 3.862086198643306*^9}, {
   3.862086233103197*^9, 3.862086249403273*^9}, 3.862087928259756*^9, 
   3.862087983773506*^9, 3.862088579768423*^9, 3.862090399761791*^9, 
   3.862090899184485*^9, 3.862091807588481*^9, 3.862095806827175*^9, 
   3.86209586429069*^9, 3.8620960312276983`*^9, {3.862096229217908*^9, 
   3.862096269111731*^9}, {3.862096302921363*^9, 3.8620963082909517`*^9}, {
   3.8620963868473988`*^9, 3.862096411533435*^9}, 3.862096567288888*^9, {
   3.86210365361801*^9, 3.86210366360275*^9}, {3.862103744975247*^9, 
   3.86210375250281*^9}, 3.862103791221567*^9, {3.862103830076783*^9, 
   3.8621038489177628`*^9}, {3.8621038861323566`*^9, 3.862103925816132*^9}, 
   3.862103964999074*^9, 3.8621040213731337`*^9, 3.862104059175126*^9, {
   3.862104129332068*^9, 3.862104151707878*^9}, 3.862104242950432*^9, {
   3.8621042905823793`*^9, 3.862104319642948*^9}, {3.862105229694881*^9, 
   3.862105240478198*^9}},
 CellLabel->"Out[16]=",ExpressionUUID->"4ed61868-0087-4673-a1d8-b0d72ebfe3c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Alpha]1", "=", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]2", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", "L", "+", 
          RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"S1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], ")"}]}], ")"}]}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Beta]1", "=", " ", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"L", "^", "2"}], " ", "\[Delta]1"}], "+", 
          RowBox[{
           RowBox[{"J", "^", "2"}], " ", "\[Delta]2"}], "+", 
          RowBox[{"S1", " ", 
           RowBox[{"(", 
            RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"S1", "+", 
             RowBox[{"S2", " ", "\[Sigma]1"}]}], ")"}]}], "+", 
          RowBox[{"L", " ", "S2", " ", "\[Delta]1", " ", "\[Sigma]2"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"L", " ", 
              RowBox[{"(", 
               RowBox[{"\[Delta]1", "+", "\[Delta]2"}], ")"}]}], "+", 
             RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "S1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], ")"}]}], ")"}]}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Alpha]2", "=", 
   RowBox[{"-", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "J"}], "+", "L", "+", 
          RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"S1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], ")"}]}], ")"}]}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Beta]2", "=", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"L", "^", "2"}], " ", "\[Delta]1"}], "+", 
          RowBox[{
           RowBox[{"J", "^", "2"}], " ", "\[Delta]2"}], "+", 
          RowBox[{"S1", " ", 
           RowBox[{"(", 
            RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"S1", "+", 
             RowBox[{"S2", " ", "\[Sigma]1"}]}], ")"}]}], "+", 
          RowBox[{"L", " ", "S2", " ", "\[Delta]1", " ", "\[Sigma]2"}], "-", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"L", " ", 
              RowBox[{"(", 
               RowBox[{"\[Delta]1", "+", "\[Delta]2"}], ")"}]}], "+", 
             RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "S1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], ")"}]}], ")"}]}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["\[Beta]1", 
      RowBox[{"Cos\[Kappa]1", "+", "\[Alpha]1"}]], "-", 
     FractionBox["\[Beta]2", 
      RowBox[{"Cos\[Kappa]1", "+", "\[Alpha]2"}]]}], ")"}], " ", "-", 
   "var2"}], "  ", "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.8620839141183558`*^9, 3.862083957628663*^9}, {
   3.862084043189763*^9, 3.862084066048606*^9}, {3.862084108375514*^9, 
   3.862084120716551*^9}, 3.862084240323819*^9, {3.86208472603526*^9, 
   3.862084763045904*^9}, {3.862084837802266*^9, 3.862084850469969*^9}, 
   3.862084966512579*^9, {3.862085636091647*^9, 3.862085651782364*^9}, {
   3.862086303114586*^9, 3.862086336567706*^9}, 3.8621043848058577`*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"82d5e006-f302-4e95-8d78-a795d1d7ff70"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.86208633338798*^9, 3.862086336969705*^9}, 
   3.8620885804668303`*^9, 3.862090400447132*^9, 3.862090899863261*^9, 
   3.8620918082727957`*^9, 3.862095981637163*^9, 3.862096039303955*^9, {
   3.862096231027481*^9, 3.862096271515234*^9}, 3.862096415503888*^9, 
   3.862096572494018*^9, 3.862104386835044*^9, {3.862105229707655*^9, 
   3.862105241425199*^9}},
 CellLabel->"Out[21]=",ExpressionUUID->"274f4989-c099-4f26-8bb0-86f4e9028f62"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.86208889910839*^9, 3.8620889009501133`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"d1a24233-497a-4de5-892f-3df587eaca2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivation of L vector: geometrical method (Eq. 3.28)", "Subsection",
 CellChangeTimes->{{3.862105603744918*^9, 3.862105627145887*^9}, {
  3.8621083699738083`*^9, 
  3.862108388017972*^9}},ExpressionUUID->"791a297d-5917-4755-9b4f-\
33e331774aaf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Jvec", " ", "=", " ", 
    RowBox[{"Lvec", " ", "+", " ", "S1vec", " ", "+", "S2vec"}]}], " ", ";"}],
   " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Seffvec", " ", "=", " ", 
   RowBox[{
    RowBox[{"\[Delta]1", " ", "S1vec"}], " ", "+", " ", 
    RowBox[{"\[Delta]2", " ", "S2vec"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cos\[Kappa]2", " ", "=", " ", 
   RowBox[{"\[Sigma]2", " ", "-", " ", 
    RowBox[{
     FractionBox[
      RowBox[{"\[Delta]1", " ", "S1"}], 
      RowBox[{"\[Delta]2", " ", "S2"}]], " ", "Cos\[Kappa]1"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cos\[Gamma]", " ", "=", " ", 
   RowBox[{"\[Sigma]1", " ", "+", " ", 
    RowBox[{
     FractionBox["L", "S2"], 
     FractionBox[
      RowBox[{"(", 
       RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], "\[Delta]2"], " ", 
     "Cos\[Kappa]1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SubsList1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Lvec", " ", "S1vec"}], "->", 
      RowBox[{"L", " ", "S1", " ", "Cos\[Kappa]1"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Lvec", " ", "S2vec"}], "->", 
      RowBox[{"L", " ", "S2", " ", "Cos\[Kappa]2"}]}], ",", "  ", 
     RowBox[{
      RowBox[{"S1vec", " ", "S2vec"}], "->", 
      RowBox[{"S1", " ", "S2", " ", "Cos\[Gamma]"}]}], ",", " ", 
     RowBox[{
      SuperscriptBox["S1vec", "2"], "->", 
      SuperscriptBox["S1", "2"]}], ",", " ", 
     RowBox[{
      SuperscriptBox["S2vec", "2"], "->", 
      SuperscriptBox["S2", "2"]}], ",", " ", 
     RowBox[{
      SuperscriptBox["Lvec", "2"], "->", 
      SuperscriptBox["L", "2"]}]}], "}"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JdSeff", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Jvec", " ", "Seffvec"}], " ", "//", "Expand"}], ")"}], 
     "      ", "/.", "SubsList1"}], "  ", "//", "Simplify"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LdSeff", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Lvec", " ", "Seffvec"}], " ", "//", "Expand"}], ")"}], "  ", "/.",
      "SubsList1"}], "  ", "//", "Simplify"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JdL", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Jvec", " ", "Lvec"}], " ", "//", "Expand"}], ")"}], "  ", "/.",
       "SubsList1"}], " ", "//", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"var1", " ", "=", " ", 
  RowBox[{
   FractionBox[
    RowBox[{"J", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"JdSeff", " ", 
        SuperscriptBox["L", "2"]}], " ", "-", " ", 
       RowBox[{"JdL", " ", "LdSeff"}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["J", "2"], 
      SuperscriptBox["L", "2"]}], " ", "-", " ", 
     SuperscriptBox["JdL", "2"]}]], " ", "//", "Simplify", " "}]}]}], "Input",\

 CellChangeTimes->{{3.8620895615038967`*^9, 3.862089607948103*^9}, {
   3.8620897958933277`*^9, 3.8620898795993156`*^9}, {3.862092684564632*^9, 
   3.86209269642277*^9}, {3.862092758687551*^9, 3.862092981223748*^9}, {
   3.862093105023377*^9, 3.862093139265238*^9}, {3.8620931887299547`*^9, 
   3.8620932423909082`*^9}, {3.86209328294075*^9, 3.862093561654439*^9}, {
   3.862093696789751*^9, 3.862093700968597*^9}, {3.86209398488211*^9, 
   3.862093998920403*^9}, {3.8620960845854807`*^9, 3.862096084874152*^9}, 
   3.8620964327096148`*^9, {3.8621050831687603`*^9, 3.862105092536888*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"104acd6d-3292-4329-8641-7d2236c3ba57"],

Cell[BoxData[
 FractionBox[
  RowBox[{"J", " ", "\[Delta]2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Cos\[Kappa]1", " ", "S1", " ", 
      RowBox[{"(", 
       RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"L", " ", 
         RowBox[{"(", 
          RowBox[{"\[Delta]1", "+", "\[Delta]2"}], ")"}]}], "+", 
        RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}]}], "+", 
     RowBox[{"\[Delta]2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["S1", "2"], " ", "\[Delta]1"}], "+", 
        RowBox[{"S1", " ", "S2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Delta]1", "+", "\[Delta]2"}], ")"}], " ", "\[Sigma]1"}], 
        "-", 
        RowBox[{
         SuperscriptBox["S2", "2"], " ", "\[Delta]2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[Sigma]2", "2"]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
  
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["Cos\[Kappa]1", "2"]}], " ", 
    SuperscriptBox["S1", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], "2"]}], "+", 
   RowBox[{"2", " ", "Cos\[Kappa]1", " ", "S1", " ", 
    RowBox[{"(", 
     RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], " ", "\[Delta]2", " ", 
    RowBox[{"(", 
     RowBox[{"L", "+", 
      RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["\[Delta]2", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["J", "2"], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"L", "+", 
         RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}], "2"]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.862093344230666*^9, 3.86209356706761*^9}, 
   3.862093701474544*^9, {3.862093987195532*^9, 3.862093999278944*^9}, 
   3.86209531091964*^9, 3.862096086699704*^9, 3.862096285193894*^9, {
   3.862096433298053*^9, 3.8620964406052637`*^9}, 3.862096695464295*^9, {
   3.862105089329648*^9, 3.8621050932625933`*^9}, 3.8621052433223886`*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"74e3c2a5-1255-4c56-a56b-6cc082747493"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Alpha]1", "=", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]2", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", "L", "+", 
          RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"S1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], ")"}]}], ")"}]}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Beta]1", "=", " ", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"L", "^", "2"}], " ", "\[Delta]1"}], "+", 
          RowBox[{
           RowBox[{"J", "^", "2"}], " ", "\[Delta]2"}], "+", 
          RowBox[{"S1", " ", 
           RowBox[{"(", 
            RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"S1", "+", 
             RowBox[{"S2", " ", "\[Sigma]1"}]}], ")"}]}], "+", 
          RowBox[{"L", " ", "S2", " ", "\[Delta]1", " ", "\[Sigma]2"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"L", " ", 
              RowBox[{"(", 
               RowBox[{"\[Delta]1", "+", "\[Delta]2"}], ")"}]}], "+", 
             RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "S1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], ")"}]}], ")"}]}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Alpha]2", "=", 
   RowBox[{"-", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "J"}], "+", "L", "+", 
          RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"S1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], ")"}]}], ")"}]}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Beta]2", "=", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"L", "^", "2"}], " ", "\[Delta]1"}], "+", 
          RowBox[{
           RowBox[{"J", "^", "2"}], " ", "\[Delta]2"}], "+", 
          RowBox[{"S1", " ", 
           RowBox[{"(", 
            RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"S1", "+", 
             RowBox[{"S2", " ", "\[Sigma]1"}]}], ")"}]}], "+", 
          RowBox[{"L", " ", "S2", " ", "\[Delta]1", " ", "\[Sigma]2"}], "-", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"L", " ", 
              RowBox[{"(", 
               RowBox[{"\[Delta]1", "+", "\[Delta]2"}], ")"}]}], "+", 
             RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "S1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], ")"}]}], ")"}]}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["\[Beta]1", 
      RowBox[{"Cos\[Kappa]1", "+", "\[Alpha]1"}]], "-", 
     FractionBox["\[Beta]2", 
      RowBox[{"Cos\[Kappa]1", "+", "\[Alpha]2"}]]}], ")"}], " ", "-", " ", 
   "var1"}], " ", "//", "Simplify", "      ", 
  RowBox[{"(*", 
   RowBox[{"This", " ", "is", " ", "actually", " ", "0.", " ", "Hence", " ", 
    RowBox[{"verified", "."}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.862093704735093*^9, 3.8620937731011257`*^9}, {
   3.862094043510868*^9, 3.862094059263382*^9}, {3.862095343206558*^9, 
   3.862095374170993*^9}, {3.862096687824645*^9, 3.862096709252877*^9}, 
   3.86210514838246*^9, {3.862105634030772*^9, 
   3.8621056505538054`*^9}},ExpressionUUID->"2490f233-051e-46d3-9125-\
4e83b272358f"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"J", " ", 
    SuperscriptBox["\[Delta]2", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["J", "2"], "-", 
      SuperscriptBox["L", "2"], "-", 
      SuperscriptBox["S1", "2"], "-", 
      SuperscriptBox["S2", "2"], "-", 
      RowBox[{"2", " ", "S1", " ", "S2", " ", "\[Sigma]1"}], "-", 
      RowBox[{"2", " ", "L", " ", "S2", " ", "\[Sigma]2"}]}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos\[Kappa]1", " ", "S1", " ", 
       RowBox[{"(", 
        RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], "+", 
      RowBox[{"\[Delta]2", " ", 
       RowBox[{"(", 
        RowBox[{"J", "-", "L", "-", 
         RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos\[Kappa]1", " ", "S1", " ", 
       RowBox[{"(", 
        RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], "-", 
      RowBox[{"\[Delta]2", " ", 
       RowBox[{"(", 
        RowBox[{"J", "+", "L", "+", 
         RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}]}]}], ")"}]}]]}]], "Output",\

 CellChangeTimes->{3.862105244802635*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"f949d0af-da9b-4c61-8dc7-0d0e1506858c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.862102253342464*^9, 3.862102256583375*^9}, {
  3.862107436674192*^9, 3.862107437886057*^9}, {3.8621082252475767`*^9, 
  3.862108238458625*^9}},ExpressionUUID->"3aea333f-c6e3-4c94-bba5-\
addf68c09a5f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eq. 3.39 derivation", "Subsection",
 CellChangeTimes->{{3.8621082475530653`*^9, 
  3.862108253073633*^9}},ExpressionUUID->"7f172cd1-07cd-454f-89d2-\
f2ae052d5e92"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"EulMatItoNI", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}], ",", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}], ",", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}]}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], ",", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}]}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], ",", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], "}"}]}], "}"}]}], "    ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LvecNI", " ", "=", " ", 
   RowBox[{"L", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S1vecNI", "=", 
   RowBox[{"S1", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Xi]3", "[", "t", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Xi]3", "[", "t", "]"}], "]"}]}], ",", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}]}], "}"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S2vecNI", "=", 
   RowBox[{"S2", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"\[Xi]3", "[", "t", "]"}], "+", 
         RowBox[{"\[CapitalDelta]\[Psi]", "[", "t", "]"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"\[Xi]3", "[", "t", "]"}], "+", 
         RowBox[{"\[CapitalDelta]\[Psi]", "[", "t", "]"}]}], "]"}]}], ",", 
      " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}]}], "}"}]}]}], "  ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SeffNI", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Delta]1", " ", "S1vecNI"}], "+", 
     RowBox[{"\[Delta]2", " ", "S2vecNI"}]}], ")"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rVecNI", " ", "=", " ", 
   RowBox[{
    RowBox[{"r", "[", "t", "]"}], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], ",", "0"}], "}"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rVecI", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Inverse", "[", "EulMatItoNI", "]"}], ".", "rVecNI"}], "      ", 
    "//", "Simplify"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drVecdtNI", " ", "=", " ", 
   RowBox[{
    RowBox[{"EulMatItoNI", ".", 
     RowBox[{"D", "[", 
      RowBox[{"rVecI", ",", "t"}], "]"}]}], "  ", "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pVecNI", " ", "=", " ", 
    RowBox[{
     RowBox[{"drVecdtNI", " ", "-", " ", 
      RowBox[{
       FractionBox["\[Epsilon]", 
        SuperscriptBox[
         RowBox[{"r", "[", "t", "]"}], "3"]], " ", 
       RowBox[{"Cross", "[", 
        RowBox[{"SeffNI", ",", "rVecNI"}], "]"}]}]}], "   ", "//", 
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cos\[Kappa]2", " ", "=", " ", 
   RowBox[{"\[Sigma]2", " ", "-", " ", 
    RowBox[{
     FractionBox[
      RowBox[{"\[Delta]1", " ", "S1"}], 
      RowBox[{"\[Delta]2", " ", "S2"}]], " ", "Cos\[Kappa]1"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cos\[Gamma]", " ", "=", " ", 
   RowBox[{"\[Sigma]1", " ", "+", " ", 
    RowBox[{
     FractionBox["L", "S2"], 
     FractionBox[
      RowBox[{"(", 
       RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], "\[Delta]2"], " ", 
     "Cos\[Kappa]1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cos\[Xi]2", "=", " ", 
   RowBox[{
    FractionBox["1", "J"], 
    RowBox[{"(", 
     RowBox[{"L", "+", 
      RowBox[{"S1", " ", "Cos\[Kappa]1"}], " ", "+", " ", 
      RowBox[{"S2", " ", "Cos\[Kappa]2"}]}], ")"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]1", "=", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]2", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", "L", "+", 
          RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"S1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], ")"}]}], ")"}]}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Beta]1", "=", " ", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"L", "^", "2"}], " ", "\[Delta]1"}], "+", 
          RowBox[{
           RowBox[{"J", "^", "2"}], " ", "\[Delta]2"}], "+", 
          RowBox[{"S1", " ", 
           RowBox[{"(", 
            RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"S1", "+", 
             RowBox[{"S2", " ", "\[Sigma]1"}]}], ")"}]}], "+", 
          RowBox[{"L", " ", "S2", " ", "\[Delta]1", " ", "\[Sigma]2"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"L", " ", 
              RowBox[{"(", 
               RowBox[{"\[Delta]1", "+", "\[Delta]2"}], ")"}]}], "+", 
             RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "S1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], ")"}]}], ")"}]}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Alpha]2", "=", 
   RowBox[{"-", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "J"}], "+", "L", "+", 
          RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"S1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], ")"}]}], ")"}]}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Beta]2", "=", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"L", "^", "2"}], " ", "\[Delta]1"}], "+", 
          RowBox[{
           RowBox[{"J", "^", "2"}], " ", "\[Delta]2"}], "+", 
          RowBox[{"S1", " ", 
           RowBox[{"(", 
            RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"S1", "+", 
             RowBox[{"S2", " ", "\[Sigma]1"}]}], ")"}]}], "+", 
          RowBox[{"L", " ", "S2", " ", "\[Delta]1", " ", "\[Sigma]2"}], "-", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"L", " ", 
              RowBox[{"(", 
               RowBox[{"\[Delta]1", "+", "\[Delta]2"}], ")"}]}], "+", 
             RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "S1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], ")"}]}], ")"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"var99", " ", "=", "  ", 
    RowBox[{
     RowBox[{
      FractionBox["\[Epsilon]", 
       SuperscriptBox[
        RowBox[{"r", "[", "t", "]"}], "3"]], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["\[Beta]1", 
         RowBox[{"Cos\[Kappa]1", "+", " ", "\[Alpha]1"}]], " ", "+", " ", 
        FractionBox["\[Beta]2", 
         RowBox[{"Cos\[Kappa]1", "+", " ", "\[Alpha]2"}]]}], ")"}]}], " ", 
     "+", " ", 
     RowBox[{
      FractionBox["L", 
       SuperscriptBox[
        RowBox[{"r", "[", "t", "]"}], "2"]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", " ", 
        RowBox[{"\[Epsilon]", 
         FractionBox[
          RowBox[{"\[Delta]1", "+", "\[Delta]2"}], 
          RowBox[{"r", "[", "t", "]"}]]}]}], ")"}]}], " ", "-", " ", 
     RowBox[{
      RowBox[{"\[Phi]", "'"}], "[", "t", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Xi]1d", " ", "=", "  ", 
    RowBox[{
     FractionBox["\[Epsilon]", 
      SuperscriptBox[
       RowBox[{"r", "[", "t", "]"}], "3"]], " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["\[Beta]1", 
        RowBox[{"Cos\[Kappa]1", "+", " ", "\[Alpha]1"}]], " ", "-", " ", 
       FractionBox["\[Beta]2", 
        RowBox[{"Cos\[Kappa]1", "+", " ", "\[Alpha]2"}]]}], ")"}]}]}], " ", 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zero1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cross", "[", 
          RowBox[{"rVecNI", ",", " ", "pVecNI"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "  ", "-", "L"}], ")"}]}], 
     SuperscriptBox[
      RowBox[{"r", "[", "t", "]"}], 
      RowBox[{"-", "2"}]]}], "//", "Simplify"}]}], "  ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"var1", " ", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"zero1", " ", "/.", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Xi]1", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], " ", "->", 
         "\[Xi]1d"}]}], "  ", "/.", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}], " ", "->", " ", 
        "Cos\[Xi]2"}]}], "/.", " ", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}], " ", "->", 
       "Cos\[Kappa]2"}]}], "/.", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}], " ", "->", 
      "Cos\[Kappa]1"}]}]}], "    ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var1", " ", "-", " ", "var99"}], " ", "//", "Simplify", 
  "                ", 
  RowBox[{"(*", 
   RowBox[{"Hence", " ", "verified"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8621062255664062`*^9, 3.862106243860633*^9}, {
   3.862106300416623*^9, 3.862106335211975*^9}, {3.862106392498508*^9, 
   3.8621064581702547`*^9}, {3.862106496068261*^9, 3.862106654486199*^9}, {
   3.862106688269462*^9, 3.862106725356902*^9}, {3.8621068154911633`*^9, 
   3.8621068726771193`*^9}, {3.8621069056045856`*^9, 3.862107141607292*^9}, {
   3.862107181965357*^9, 3.8621071934416943`*^9}, {3.862107316576049*^9, 
   3.8621073303024883`*^9}, 3.862107415147767*^9, {3.86210744548202*^9, 
   3.8621076438446503`*^9}, {3.862107718220296*^9, 3.86210774334295*^9}, {
   3.862107788366747*^9, 3.862107896787293*^9}, {3.862107949280595*^9, 
   3.86210796328046*^9}, {3.86210799986584*^9, 3.862108137535829*^9}, {
   3.862108263340452*^9, 
   3.8621082781965857`*^9}},ExpressionUUID->"d0ba0f04-b3d5-48c6-8500-\
0f9e6e8b5ad2"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.862108082116901*^9, 3.862108105805644*^9}, 
   3.862108137932246*^9, {3.8621082679540997`*^9, 3.862108270779825*^9}},
 CellLabel->
  "Out[262]=",ExpressionUUID->"f2fee574-6f5a-4dae-88ea-f2ef83b61a48"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.862107964703418*^9, 3.862107986811067*^9}, 
   3.8621080694300327`*^9, {3.862109139838278*^9, 3.862109142260911*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"bc0eead7-5904-485a-a0bb-4693e3012601"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8621091450599527`*^9, 
  3.8621091455392857`*^9}},ExpressionUUID->"e1162ebe-4c8d-4ef0-b6e7-\
fccd9471eea6"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["d\[Phi]", "r"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "40450d34-4be9-45fc-894c-2020f4da2820"],
 "/dt calculation with 1PN included"
}], "Subsubsection",
 CellChangeTimes->{{3.862109171209648*^9, 3.862109259608183*^9}, {
   3.8621093152243147`*^9, 3.862109399154978*^9}, 3.862111254693211*^9, {
   3.862113948916198*^9, 3.862113967300335*^9}, 3.8621143366952887`*^9, {
   3.8621310584679003`*^9, 
   3.862131059787109*^9}},ExpressionUUID->"e456f7a6-1d02-4db4-bb89-\
be24f785c95e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]", " ", "=", " ", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"3", "+", "\[Nu]"}], ")"}]}]}], " ", ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"3", " ", "\[Nu]"}], "-", "1"}], ")"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]", "=", " ", 
   RowBox[{"(", 
    RowBox[{"4", "-", "\[Nu]"}], ")"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]", "=", 
    RowBox[{"(", 
     RowBox[{"6", "+", "\[Nu]"}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var1", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "RdVec"}], "  ", "+", "Pvec", " ", "+", " ", 
    RowBox[{"\[Epsilon]", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], "\[Nu]", " ", 
         RowBox[{"(", "PdR", ")"}], "Rvec"}], "  ", "-", " ", 
        RowBox[{"\[Alpha]", " ", 
         SuperscriptBox["R", "2"], " ", "Pvec"}], " ", "+", " ", 
        RowBox[{"\[Beta]", " ", 
         SuperscriptBox["P", "2"], 
         SuperscriptBox["R", "3"], " ", "Pvec"}], "  ", "-", " ", 
        RowBox[{"2", " ", "RCrossSeff"}]}], " ", ")"}], 
      RowBox[{"2", " ", 
       SuperscriptBox["R", "3"]}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pvecsol", " ", "=", " ", 
   RowBox[{"Pvec", "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"var1", "==", "0"}], ",", " ", "Pvec"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pvecsol", "=", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{"Pvecsol", ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "  ", "//",
     "Normal"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", 
  RowBox[{"Pvecsol", ",", 
   RowBox[{"{", 
    RowBox[{"\[Epsilon]", ",", " ", "RdVec", ",", " ", "R"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.862112485286559*^9, 3.86211261649767*^9}, {
  3.862112649638329*^9, 3.862112755794025*^9}, {3.862112860421921*^9, 
  3.862112895958809*^9}, {3.862112942997917*^9, 3.862112992897423*^9}, {
  3.8621130558708267`*^9, 3.862113071560196*^9}, {3.862124267775262*^9, 
  3.862124294567792*^9}, {3.862125383030426*^9, 3.862125385865735*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"170ba6c9-cfcf-4504-9d5b-e5acabe817c9"],

Cell[BoxData[
 RowBox[{"RdVec", "+", 
  RowBox[{"\[Epsilon]", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"RCrossSeff", "+", 
       RowBox[{"PdR", " ", "Rvec", " ", "\[Nu]"}]}], 
      SuperscriptBox["R", "3"]], "+", 
     RowBox[{"RdVec", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         SuperscriptBox["P", "2"], "2"], "-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox["P", "2"], " ", "\[Nu]"}], "2"], "+", 
        FractionBox[
         RowBox[{"3", "+", "\[Nu]"}], "R"]}], ")"}]}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{{3.86211298833862*^9, 3.8621129932032623`*^9}, {
   3.862113057107839*^9, 3.86211307212001*^9}, 3.862123099931398*^9, 
   3.8621250358224497`*^9, 3.862125394370524*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"a97a0465-8463-4117-99cd-9657be8d978d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"EulMatItoNI", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}], ",", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}], ",", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}]}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], ",", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}]}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], ",", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], "}"}]}], "}"}]}], "    ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LvecNI", " ", "=", " ", 
   RowBox[{"L", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S1vecNI", "=", 
   RowBox[{"S1", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Xi]3", "[", "t", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Xi]3", "[", "t", "]"}], "]"}]}], ",", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}]}], "}"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S2vecNI", "=", 
   RowBox[{"S2", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"\[Xi]3", "[", "t", "]"}], "+", 
         RowBox[{"\[CapitalDelta]\[Psi]", "[", "t", "]"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"\[Xi]3", "[", "t", "]"}], "+", 
         RowBox[{"\[CapitalDelta]\[Psi]", "[", "t", "]"}]}], "]"}]}], ",", 
      " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}]}], "}"}]}]}], "  ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SeffNI", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Delta]1", " ", "S1vecNI"}], "+", 
     RowBox[{"\[Delta]2", " ", "S2vecNI"}]}], ")"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rVecNI", " ", "=", " ", 
   RowBox[{
    RowBox[{"r", "[", "t", "]"}], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], ",", "0"}], "}"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rVecI", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Inverse", "[", "EulMatItoNI", "]"}], ".", "rVecNI"}], "      ", 
    "//", "Simplify"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"drVecdtNI", " ", "=", " ", 
    RowBox[{
     RowBox[{"EulMatItoNI", ".", 
      RowBox[{"D", "[", 
       RowBox[{"rVecI", ",", "t"}], "]"}]}], "  ", "//", "Simplify"}]}], " ", 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pVecNI", " ", "=", " ", 
   RowBox[{
    RowBox[{"drVecdtNI", "+", 
     RowBox[{"\[Epsilon]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"drVecdtNI", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["\[Alpha]", 
            RowBox[{"2", " ", 
             RowBox[{"r", "[", "t", "]"}]}]], "-", 
           FractionBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"p", "[", "t", "]"}], "2"], " ", "\[Beta]"}], "2"]}], 
          ")"}]}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{"rVecNI", ",", "SeffNI"}], "]"}], "+", 
          RowBox[{"\[Nu]", " ", "pdr", " ", "rVecNI", " "}]}], 
         SuperscriptBox[
          RowBox[{"r", "[", "t", "]"}], "3"]]}], ")"}]}]}], 
    "                  ", "//", "Simplify"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zero1", " ", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cross", "[", 
         RowBox[{"rVecNI", ",", " ", "pVecNI"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "  ", "-", "L"}], ")"}], "  ", "//", 
     "FullSimplify"}], "  ", ")"}]}], "  ", ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Phi]dsol", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "'"}], "[", "t", "]"}], "/.", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"zero1", "==", "0"}], ",", 
         RowBox[{
          RowBox[{"\[Phi]", "'"}], "[", "t", "]"}]}], "]"}], "  ", "//", 
       "FullSimplify"}], ")"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], " ", "/.", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"p", "[", "t", "]"}], "2"], "->", " ", 
    RowBox[{
     SuperscriptBox["pdn", "2"], "+", 
     FractionBox[
      SuperscriptBox["L", "2"], 
      SuperscriptBox[
       RowBox[{"r", "[", "t", "]"}], "2"]]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.86211328118604*^9, 3.862113619507064*^9}, {
   3.862123103145419*^9, 3.862123120462285*^9}, {3.862123169664687*^9, 
   3.862123170465604*^9}, 3.862123301906782*^9, {3.86212341211674*^9, 
   3.8621234386499643`*^9}, {3.862123771018113*^9, 3.8621238057305393`*^9}, 
   3.8621238802890053`*^9, 3.8621239363875732`*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"f302f918-fc19-4700-a8f1-4d5a12c36d3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"S1", " ", "\[Delta]1", " ", "\[Epsilon]", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"S2", " ", "\[Delta]2", " ", "\[Epsilon]", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"L", " ", 
        RowBox[{"r", "[", "t", "]"}]}]}], ")"}]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"r", "[", "t", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", "\[Nu]"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"3", " ", "\[Nu]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["pdn", "2"], "+", 
             FractionBox[
              SuperscriptBox["L", "2"], 
              SuperscriptBox[
               RowBox[{"r", "[", "t", "]"}], "2"]]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"r", "[", "t", "]"}]}]}], ")"}]}]]}], "-", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["\[Xi]1", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.8621134989596148`*^9, 3.862113620560176*^9}, {
   3.8621231036933517`*^9, 3.862123120848813*^9}, 3.862123170903633*^9, 
   3.862123342548246*^9, 3.862123439146812*^9, 3.862123810787746*^9, 
   3.862123882634562*^9, 3.862123938508432*^9, 3.862124820025723*^9, 
   3.862125041385375*^9, 3.862125401800042*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"df090d48-2159-4e9a-be0b-1d12773ba845"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Cos\[Kappa]2", " ", "=", " ", 
   RowBox[{"\[Sigma]2", " ", "-", " ", 
    RowBox[{
     FractionBox[
      RowBox[{"\[Delta]1", " ", "S1"}], 
      RowBox[{"\[Delta]2", " ", "S2"}]], " ", "Cos\[Kappa]1"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cos\[Gamma]", " ", "=", " ", 
   RowBox[{"\[Sigma]1", " ", "+", " ", 
    RowBox[{
     FractionBox["L", "S2"], 
     FractionBox[
      RowBox[{"(", 
       RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], "\[Delta]2"], " ", 
     "Cos\[Kappa]1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cos\[Xi]2", "=", " ", 
   RowBox[{
    FractionBox["1", "J"], 
    RowBox[{"(", 
     RowBox[{"L", "+", 
      RowBox[{"S1", " ", "Cos\[Kappa]1"}], " ", "+", " ", 
      RowBox[{"S2", " ", "Cos\[Kappa]2"}]}], ")"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]1", "=", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]2", " ", 
        RowBox[{"(", 
         RowBox[{"J", "+", "L", "+", 
          RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"S1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], ")"}]}], ")"}]}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Beta]1", "=", " ", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"L", "^", "2"}], " ", "\[Delta]1"}], "+", 
          RowBox[{
           RowBox[{"J", "^", "2"}], " ", "\[Delta]2"}], "+", 
          RowBox[{"S1", " ", 
           RowBox[{"(", 
            RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"S1", "+", 
             RowBox[{"S2", " ", "\[Sigma]1"}]}], ")"}]}], "+", 
          RowBox[{"L", " ", "S2", " ", "\[Delta]1", " ", "\[Sigma]2"}], "+", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"L", " ", 
              RowBox[{"(", 
               RowBox[{"\[Delta]1", "+", "\[Delta]2"}], ")"}]}], "+", 
             RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "S1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], ")"}]}], ")"}]}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Alpha]2", "=", 
   RowBox[{"-", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "J"}], "+", "L", "+", 
          RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"S1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], ")"}]}], ")"}]}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Beta]2", "=", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"L", "^", "2"}], " ", "\[Delta]1"}], "+", 
          RowBox[{
           RowBox[{"J", "^", "2"}], " ", "\[Delta]2"}], "+", 
          RowBox[{"S1", " ", 
           RowBox[{"(", 
            RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"S1", "+", 
             RowBox[{"S2", " ", "\[Sigma]1"}]}], ")"}]}], "+", 
          RowBox[{"L", " ", "S2", " ", "\[Delta]1", " ", "\[Sigma]2"}], "-", 
          RowBox[{"J", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"L", " ", 
              RowBox[{"(", 
               RowBox[{"\[Delta]1", "+", "\[Delta]2"}], ")"}]}], "+", 
             RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "S1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], ")"}]}], ")"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Xi]1d", " ", "=", "  ", 
    RowBox[{
     FractionBox["\[Epsilon]", 
      SuperscriptBox[
       RowBox[{"r", "[", "t", "]"}], "3"]], " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["\[Beta]1", 
        RowBox[{"Cos\[Kappa]1", "+", " ", "\[Alpha]1"}]], " ", "-", " ", 
       FractionBox["\[Beta]2", 
        RowBox[{"Cos\[Kappa]1", "+", " ", "\[Alpha]2"}]]}], ")"}]}]}], " ", 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pdnSol", " ", "=", "  ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "H"}], " ", "+", " ", 
        RowBox[{"\[Epsilon]", 
         RowBox[{"(", 
          RowBox[{"-", "\[Beta]"}], ")"}], 
         SuperscriptBox["H", "2"]}]}], ")"}], " ", "+", " ", 
      FractionBox[
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", " ", "+", " ", 
          RowBox[{"\[Epsilon]", " ", "\[Gamma]", " ", "H"}]}], ")"}]}], 
       RowBox[{"r", "[", "t", "]"}]], " ", "+", " ", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["L", "2"]}], "+", 
         RowBox[{"\[Epsilon]", " ", "\[Delta]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"r", "[", "t", "]"}], "2"]], " ", "+", " ", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "\[Epsilon]"}], " ", "\[Nu]", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["L", "2"], "+", " ", 
          RowBox[{"2", 
           RowBox[{"SeffdL", "/", "\[Nu]"}]}]}], ")"}], " "}], 
       SuperscriptBox[
        RowBox[{"r", "[", "t", "]"}], "3"]]}], "  ", ")"}], 
    RowBox[{"1", "/", "2"}]]}], "  ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]dsol2", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Series", "[", 
            RowBox[{"\[Phi]dsol", ",", " ", 
             RowBox[{"{", 
              RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//",
            "Normal"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"\[Epsilon]", ",", 
            RowBox[{"r", "[", "t", "]"}]}], "}"}]}], "]"}], "  ", "/.", 
        RowBox[{
         RowBox[{"S2", " ", "\[Delta]2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}]}], "->", 
         RowBox[{
          FractionBox["SeffdL", "L"], " ", "-", " ", 
          RowBox[{"S1", " ", "\[Delta]1", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}]}]}]}]}], "/.", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Xi]1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "->", "\[Xi]1d"}]}], " ",
       "/.", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}], "->", " ", "Cos\[Xi]2"}]}], 
     " ", "/.", 
     RowBox[{"pdn", "->", "pdnSol"}]}], "//", "Simplify"}]}], "  ", 
  ";"}]}], "Input",
 CellChangeTimes->{{3.862123450793851*^9, 3.8621234629851513`*^9}, {
   3.862123495546339*^9, 3.862123602782057*^9}, {3.862123849122921*^9, 
   3.862123856678706*^9}, {3.862123948573954*^9, 3.8621239513882437`*^9}, {
   3.8621242159419937`*^9, 3.8621242206262093`*^9}, {3.862124253142139*^9, 
   3.862124318284026*^9}, {3.862124528444213*^9, 3.862124560724555*^9}, {
   3.8621245964546022`*^9, 3.862124717296137*^9}, {3.8621248058999777`*^9, 
   3.862124892649519*^9}, {3.8621249531324797`*^9, 3.862124978878119*^9}, 
   3.862125417263938*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"9a0bac70-a7c0-485b-a976-6670343d5b34"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Apart", "[", 
   RowBox[{"\[Phi]dsol2", ",", " ", "Cos\[Kappa]1"}], " ", "]"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]dsol2b", "=", 
   RowBox[{
    RowBox[{"\[Phi]dsol2", "-", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[Delta]2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "J"}], " ", "L", " ", "\[Delta]1", " ", 
             "\[Epsilon]"}], "+", 
            RowBox[{
             SuperscriptBox["L", "2"], " ", "\[Delta]1", " ", "\[Epsilon]"}], 
            "+", 
            RowBox[{
             SuperscriptBox["S1", "2"], " ", "\[Delta]1", " ", "\[Epsilon]"}],
             "+", 
            RowBox[{
             SuperscriptBox["J", "2"], " ", "\[Delta]2", " ", "\[Epsilon]"}], 
            "-", 
            RowBox[{"J", " ", "L", " ", "\[Delta]2", " ", "\[Epsilon]"}], "-", 
            RowBox[{
             SuperscriptBox["S1", "2"], " ", "\[Delta]2", " ", "\[Epsilon]"}],
             "+", 
            RowBox[{
            "S1", " ", "S2", " ", "\[Delta]1", " ", "\[Epsilon]", " ", 
             "\[Sigma]1"}], "-", 
            RowBox[{
            "S1", " ", "S2", " ", "\[Delta]2", " ", "\[Epsilon]", " ", 
             "\[Sigma]1"}], "+", 
            RowBox[{
            "L", " ", "S2", " ", "\[Delta]1", " ", "\[Epsilon]", " ", 
             "\[Sigma]2"}], "-", 
            RowBox[{
            "J", " ", "S2", " ", "\[Delta]2", " ", "\[Epsilon]", " ", 
             "\[Sigma]2"}]}], ")"}]}], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"J", " ", "\[Delta]2"}], "-", 
            RowBox[{"L", " ", "\[Delta]2"}], "+", 
            RowBox[{"Cos\[Kappa]1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"S1", " ", "\[Delta]1"}], "-", 
               RowBox[{"S1", " ", "\[Delta]2"}]}], ")"}]}], "-", 
            RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}], " ", 
          
          SuperscriptBox[
           RowBox[{"r", "[", "t", "]"}], "3"]}]]}], "-", 
       FractionBox[
        RowBox[{"\[Delta]2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "L", " ", "\[Delta]1", " ", "\[Epsilon]"}], "+", 
           
           RowBox[{
            SuperscriptBox["L", "2"], " ", "\[Delta]1", " ", "\[Epsilon]"}], 
           "+", 
           RowBox[{
            SuperscriptBox["S1", "2"], " ", "\[Delta]1", " ", "\[Epsilon]"}], 
           "+", 
           RowBox[{
            SuperscriptBox["J", "2"], " ", "\[Delta]2", " ", "\[Epsilon]"}], 
           "+", 
           RowBox[{"J", " ", "L", " ", "\[Delta]2", " ", "\[Epsilon]"}], "-", 
           
           RowBox[{
            SuperscriptBox["S1", "2"], " ", "\[Delta]2", " ", "\[Epsilon]"}], 
           "+", 
           RowBox[{
           "S1", " ", "S2", " ", "\[Delta]1", " ", "\[Epsilon]", " ", 
            "\[Sigma]1"}], "-", 
           RowBox[{
           "S1", " ", "S2", " ", "\[Delta]2", " ", "\[Epsilon]", " ", 
            "\[Sigma]1"}], "+", 
           RowBox[{
           "L", " ", "S2", " ", "\[Delta]1", " ", "\[Epsilon]", " ", 
            "\[Sigma]2"}], "+", 
           RowBox[{
           "J", " ", "S2", " ", "\[Delta]2", " ", "\[Epsilon]", " ", 
            "\[Sigma]2"}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "J"}], " ", "\[Delta]2"}], "-", 
           RowBox[{"L", " ", "\[Delta]2"}], "+", 
           RowBox[{"Cos\[Kappa]1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"S1", " ", "\[Delta]1"}], "-", 
              RowBox[{"S1", " ", "\[Delta]2"}]}], ")"}]}], "-", 
           RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"r", "[", "t", "]"}], "3"]}]]}], ")"}]}], "  ", "//", 
    "Simplify"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", 
  RowBox[{"\[Phi]dsol2b", ",", " ", 
   RowBox[{"r", "[", "t", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8621248963643723`*^9, 3.862124910422132*^9}, {
  3.862124976346292*^9, 3.862124997018539*^9}, {3.862125073506501*^9, 
  3.86212509317041*^9}, {3.862125134456036*^9, 3.862125195111409*^9}, {
  3.86212525838658*^9, 3.8621252643458643`*^9}, {3.862125430204719*^9, 
  3.8621254505490503`*^9}, {3.862125490069604*^9, 3.862125536573455*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"a82846e3-06b9-41ff-9ab1-5fc4d8bfb642"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"L", " ", 
     SuperscriptBox["\[Epsilon]", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"3", " ", "\[Nu]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "SeffdL"}], "+", 
       RowBox[{
        SuperscriptBox["L", "2"], " ", "\[Nu]"}]}], ")"}]}], 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"r", "[", "t", "]"}], "5"]}]]}], "+", 
  FractionBox[
   RowBox[{"L", " ", 
    SuperscriptBox["\[Epsilon]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "6"}], "+", 
      RowBox[{"17", " ", "\[Nu]"}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"r", "[", "t", "]"}], "4"]}]], "-", 
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "SeffdL"}], "+", 
      RowBox[{
       SuperscriptBox["L", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "\[Delta]1", "+", "\[Delta]2", "+", 
         RowBox[{"4", " ", "H", " ", "\[Epsilon]"}], "-", 
         RowBox[{"2", " ", "\[Nu]"}], "-", 
         RowBox[{"13", " ", "H", " ", "\[Epsilon]", " ", "\[Nu]"}], "+", 
         RowBox[{"3", " ", "H", " ", "\[Epsilon]", " ", 
          SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}], "+", 
      RowBox[{"L", " ", "S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}]}], 
   RowBox[{"L", " ", 
    SuperscriptBox[
     RowBox[{"r", "[", "t", "]"}], "3"]}]], "+", 
  FractionBox[
   RowBox[{"L", " ", 
    RowBox[{"(", 
     RowBox[{"2", "-", 
      RowBox[{
       SuperscriptBox["H", "2"], " ", 
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"3", " ", "\[Nu]"}]}], ")"}], "2"]}], "+", 
      RowBox[{"2", " ", "H", " ", "\[Epsilon]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"3", " ", "\[Nu]"}]}], ")"}]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"r", "[", "t", "]"}], "2"]}]]}]], "Output",
 CellChangeTimes->{{3.8621254379447803`*^9, 3.8621254517568913`*^9}, {
  3.8621255132637997`*^9, 3.8621255369284563`*^9}},
 CellLabel->"Out[42]=",ExpressionUUID->"bb9c0c04-0554-498c-8ab0-19fcc942fa66"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"partialFracPart", "=", " ", 
  RowBox[{"Apart", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[Delta]2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "J"}], " ", "L", " ", "\[Delta]1", " ", 
            "\[Epsilon]"}], "+", 
           RowBox[{
            SuperscriptBox["L", "2"], " ", "\[Delta]1", " ", "\[Epsilon]"}], 
           "+", 
           RowBox[{
            SuperscriptBox["S1", "2"], " ", "\[Delta]1", " ", "\[Epsilon]"}], 
           "+", 
           RowBox[{
            SuperscriptBox["J", "2"], " ", "\[Delta]2", " ", "\[Epsilon]"}], 
           "-", 
           RowBox[{"J", " ", "L", " ", "\[Delta]2", " ", "\[Epsilon]"}], "-", 
           
           RowBox[{
            SuperscriptBox["S1", "2"], " ", "\[Delta]2", " ", "\[Epsilon]"}], 
           "+", 
           RowBox[{
           "S1", " ", "S2", " ", "\[Delta]1", " ", "\[Epsilon]", " ", 
            "\[Sigma]1"}], "-", 
           RowBox[{
           "S1", " ", "S2", " ", "\[Delta]2", " ", "\[Epsilon]", " ", 
            "\[Sigma]1"}], "+", 
           RowBox[{
           "L", " ", "S2", " ", "\[Delta]1", " ", "\[Epsilon]", " ", 
            "\[Sigma]2"}], "-", 
           RowBox[{
           "J", " ", "S2", " ", "\[Delta]2", " ", "\[Epsilon]", " ", 
            "\[Sigma]2"}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", "\[Delta]2"}], "-", 
           RowBox[{"L", " ", "\[Delta]2"}], "+", 
           RowBox[{"Cos\[Kappa]1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"S1", " ", "\[Delta]1"}], "-", 
              RowBox[{"S1", " ", "\[Delta]2"}]}], ")"}]}], "-", 
           RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"r", "[", "t", "]"}], "3"]}]]}], "-", 
      FractionBox[
       RowBox[{"\[Delta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"J", " ", "L", " ", "\[Delta]1", " ", "\[Epsilon]"}], "+", 
          RowBox[{
           SuperscriptBox["L", "2"], " ", "\[Delta]1", " ", "\[Epsilon]"}], 
          "+", 
          RowBox[{
           SuperscriptBox["S1", "2"], " ", "\[Delta]1", " ", "\[Epsilon]"}], 
          "+", 
          RowBox[{
           SuperscriptBox["J", "2"], " ", "\[Delta]2", " ", "\[Epsilon]"}], 
          "+", 
          RowBox[{"J", " ", "L", " ", "\[Delta]2", " ", "\[Epsilon]"}], "-", 
          RowBox[{
           SuperscriptBox["S1", "2"], " ", "\[Delta]2", " ", "\[Epsilon]"}], 
          "+", 
          RowBox[{
          "S1", " ", "S2", " ", "\[Delta]1", " ", "\[Epsilon]", " ", 
           "\[Sigma]1"}], "-", 
          RowBox[{
          "S1", " ", "S2", " ", "\[Delta]2", " ", "\[Epsilon]", " ", 
           "\[Sigma]1"}], "+", 
          RowBox[{
          "L", " ", "S2", " ", "\[Delta]1", " ", "\[Epsilon]", " ", 
           "\[Sigma]2"}], "+", 
          RowBox[{
          "J", " ", "S2", " ", "\[Delta]2", " ", "\[Epsilon]", " ", 
           "\[Sigma]2"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "J"}], " ", "\[Delta]2"}], "-", 
          RowBox[{"L", " ", "\[Delta]2"}], "+", 
          RowBox[{"Cos\[Kappa]1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"S1", " ", "\[Delta]1"}], "-", 
             RowBox[{"S1", " ", "\[Delta]2"}]}], ")"}]}], "-", 
          RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"r", "[", "t", "]"}], "3"]}]]}], ")"}], " ", ",", 
    "Cos\[Kappa]1"}], " ", "]"}]}]], "Input",
 CellChangeTimes->{{3.862125272079026*^9, 3.86212530666833*^9}, 
   3.8621254339065123`*^9, {3.862127277947896*^9, 3.862127342786004*^9}, {
   3.8621276317539377`*^9, 3.86212763225972*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"c8022341-1c59-40d6-9cd7-45e9c8c56cc6"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[Delta]2", " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "J"}], " ", "L", " ", "\[Delta]1"}], "+", 
      RowBox[{
       SuperscriptBox["L", "2"], " ", "\[Delta]1"}], "+", 
      RowBox[{
       SuperscriptBox["S1", "2"], " ", "\[Delta]1"}], "+", 
      RowBox[{
       SuperscriptBox["J", "2"], " ", "\[Delta]2"}], "-", 
      RowBox[{"J", " ", "L", " ", "\[Delta]2"}], "-", 
      RowBox[{
       SuperscriptBox["S1", "2"], " ", "\[Delta]2"}], "+", 
      RowBox[{"S1", " ", "S2", " ", "\[Delta]1", " ", "\[Sigma]1"}], "-", 
      RowBox[{"S1", " ", "S2", " ", "\[Delta]2", " ", "\[Sigma]1"}], "+", 
      RowBox[{"L", " ", "S2", " ", "\[Delta]1", " ", "\[Sigma]2"}], "-", 
      RowBox[{"J", " ", "S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "Cos\[Kappa]1"}], " ", "S1", " ", "\[Delta]1"}], "-", 
      RowBox[{"J", " ", "\[Delta]2"}], "+", 
      RowBox[{"L", " ", "\[Delta]2"}], "+", 
      RowBox[{"Cos\[Kappa]1", " ", "S1", " ", "\[Delta]2"}], "+", 
      RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"r", "[", "t", "]"}], "3"]}]], "+", 
  FractionBox[
   RowBox[{"\[Delta]2", " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"J", " ", "L", " ", "\[Delta]1"}], "+", 
      RowBox[{
       SuperscriptBox["L", "2"], " ", "\[Delta]1"}], "+", 
      RowBox[{
       SuperscriptBox["S1", "2"], " ", "\[Delta]1"}], "+", 
      RowBox[{
       SuperscriptBox["J", "2"], " ", "\[Delta]2"}], "+", 
      RowBox[{"J", " ", "L", " ", "\[Delta]2"}], "-", 
      RowBox[{
       SuperscriptBox["S1", "2"], " ", "\[Delta]2"}], "+", 
      RowBox[{"S1", " ", "S2", " ", "\[Delta]1", " ", "\[Sigma]1"}], "-", 
      RowBox[{"S1", " ", "S2", " ", "\[Delta]2", " ", "\[Sigma]1"}], "+", 
      RowBox[{"L", " ", "S2", " ", "\[Delta]1", " ", "\[Sigma]2"}], "+", 
      RowBox[{"J", " ", "S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "Cos\[Kappa]1"}], " ", "S1", " ", "\[Delta]1"}], "+", 
      RowBox[{"J", " ", "\[Delta]2"}], "+", 
      RowBox[{"L", " ", "\[Delta]2"}], "+", 
      RowBox[{"Cos\[Kappa]1", " ", "S1", " ", "\[Delta]2"}], "+", 
      RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"r", "[", "t", "]"}], "3"]}]]}]], "Output",
 CellChangeTimes->{{3.862127322201848*^9, 3.8621273432985573`*^9}, 
   3.862127633338416*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"0fc221e3-96f3-4581-85ba-4adeaaf370ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Beta]1r", " ", "=", " ", 
   FractionBox[
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"\[Delta]2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "J"}], " ", "L", " ", "\[Delta]1", " ", "\[Epsilon]"}],
          "+", 
         RowBox[{
          SuperscriptBox["L", "2"], " ", "\[Delta]1", " ", "\[Epsilon]"}], 
         "+", 
         RowBox[{
          SuperscriptBox["S1", "2"], " ", "\[Delta]1", " ", "\[Epsilon]"}], 
         "+", 
         RowBox[{
          SuperscriptBox["J", "2"], " ", "\[Delta]2", " ", "\[Epsilon]"}], 
         "-", 
         RowBox[{"J", " ", "L", " ", "\[Delta]2", " ", "\[Epsilon]"}], "-", 
         RowBox[{
          SuperscriptBox["S1", "2"], " ", "\[Delta]2", " ", "\[Epsilon]"}], 
         "+", 
         RowBox[{
         "S1", " ", "S2", " ", "\[Delta]1", " ", "\[Epsilon]", " ", 
          "\[Sigma]1"}], "-", 
         RowBox[{
         "S1", " ", "S2", " ", "\[Delta]2", " ", "\[Epsilon]", " ", 
          "\[Sigma]1"}], "+", 
         RowBox[{
         "L", " ", "S2", " ", "\[Delta]1", " ", "\[Epsilon]", " ", 
          "\[Sigma]2"}], "-", 
         RowBox[{
         "J", " ", "S2", " ", "\[Delta]2", " ", "\[Epsilon]", " ", 
          "\[Sigma]2"}]}], ")"}]}], ")"}]}], 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"S1", " ", "\[Delta]1"}], "-", 
       RowBox[{"S1", " ", "\[Delta]2"}]}], ")"}], "\[Epsilon]"}]]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]2r", "=", 
   RowBox[{
    RowBox[{"-", "\[Delta]2"}], " ", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"J", " ", "L", " ", "\[Delta]1", " ", "\[Epsilon]"}], "+", 
       RowBox[{
        SuperscriptBox["L", "2"], " ", "\[Delta]1", " ", "\[Epsilon]"}], "+", 
       
       RowBox[{
        SuperscriptBox["S1", "2"], " ", "\[Delta]1", " ", "\[Epsilon]"}], "+", 
       RowBox[{
        SuperscriptBox["J", "2"], " ", "\[Delta]2", " ", "\[Epsilon]"}], "+", 
       
       RowBox[{"J", " ", "L", " ", "\[Delta]2", " ", "\[Epsilon]"}], "-", 
       RowBox[{
        SuperscriptBox["S1", "2"], " ", "\[Delta]2", " ", "\[Epsilon]"}], "+", 
       RowBox[{
       "S1", " ", "S2", " ", "\[Delta]1", " ", "\[Epsilon]", " ", 
        "\[Sigma]1"}], "-", 
       RowBox[{
       "S1", " ", "S2", " ", "\[Delta]2", " ", "\[Epsilon]", " ", 
        "\[Sigma]1"}], "+", 
       RowBox[{
       "L", " ", "S2", " ", "\[Delta]1", " ", "\[Epsilon]", " ", 
        "\[Sigma]2"}], "+", 
       RowBox[{
       "J", " ", "S2", " ", "\[Delta]2", " ", "\[Epsilon]", " ", 
        "\[Sigma]2"}]}], ")"}], 
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"S1", " ", "\[Delta]1"}], "-", 
        RowBox[{"S1", " ", "\[Delta]2"}]}], ")"}], "\[Epsilon]"}]]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]1r", " ", "=", " ", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"J", " ", "\[Delta]2"}], "-", 
      RowBox[{"L", " ", "\[Delta]2"}], "-", 
      RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"S1", " ", "\[Delta]1"}], "-", 
      RowBox[{"S1", " ", "\[Delta]2"}]}], ")"}]]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]2r", " ", "=", "  ", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "J"}], " ", "\[Delta]2"}], "-", 
      RowBox[{"L", " ", "\[Delta]2"}], "-", 
      RowBox[{"S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"S1", " ", "\[Delta]1"}], "-", 
      RowBox[{"S1", " ", "\[Delta]2"}]}], ")"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"partialFracPartB", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"r", "[", "t", "]"}], 
        RowBox[{"-", "3"}]], "\[Epsilon]"}], ")"}], " ", 
     RowBox[{"(", " ", 
      RowBox[{
       FractionBox["\[Beta]1r", 
        RowBox[{"Cos\[Kappa]1", "+", "\[Alpha]1r"}]], "+", " ", 
       FractionBox["\[Beta]2r", 
        RowBox[{"Cos\[Kappa]1", "+", "\[Alpha]2r"}]]}], ")"}]}], " ", "-", 
    " ", "partialFracPart"}], "  ", "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.862127363836684*^9, 3.862127661187052*^9}, {
  3.862127698372727*^9, 3.862127725609043*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"6f2cbbd2-ca4a-4f94-90ec-cb506ffd281c"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Delta]2", " ", "\[Epsilon]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["J", "2"], " ", "L", " ", "\[Delta]1", " ", 
          "\[Delta]2"}], "+", 
         RowBox[{"Cos\[Kappa]1", " ", "S1", " ", 
          RowBox[{"(", 
           RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["L", "2"], " ", "\[Delta]1"}], "+", 
            RowBox[{
             SuperscriptBox["S1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["J", "2"], " ", "\[Delta]2"}], "+", 
            RowBox[{"S1", " ", "S2", " ", 
             RowBox[{"(", 
              RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], " ", 
             "\[Sigma]1"}], "+", 
            RowBox[{"L", " ", "S2", " ", "\[Delta]1", " ", "\[Sigma]2"}]}], 
           ")"}]}], "-", 
         RowBox[{"\[Delta]2", " ", 
          RowBox[{"(", 
           RowBox[{"L", "+", 
            RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["L", "2"], " ", "\[Delta]1"}], "+", 
            RowBox[{"S1", " ", 
             RowBox[{"(", 
              RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"S1", "+", 
               RowBox[{"S2", " ", "\[Sigma]1"}]}], ")"}]}], "+", 
            RowBox[{"L", " ", "S2", " ", "\[Delta]1", " ", "\[Sigma]2"}]}], 
           ")"}]}]}], ")"}]}], "+", 
      RowBox[{"partialFracPart", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["Cos\[Kappa]1", "2"], " ", 
          SuperscriptBox["S1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], "2"]}], "-", 
         RowBox[{"2", " ", "Cos\[Kappa]1", " ", "S1", " ", 
          RowBox[{"(", 
           RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}], " ", "\[Delta]2", 
          " ", 
          RowBox[{"(", 
           RowBox[{"L", "+", 
            RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[Delta]2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["J", "2"]}], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"L", "+", 
               RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}], "2"]}], ")"}]}]}], 
        ")"}], " ", 
       SuperscriptBox[
        RowBox[{"r", "[", "t", "]"}], "3"]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos\[Kappa]1", " ", "S1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], "+", 
        RowBox[{"\[Delta]2", " ", 
         RowBox[{"(", 
          RowBox[{"J", "-", "L", "-", 
           RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos\[Kappa]1", " ", "S1", " ", 
         RowBox[{"(", 
          RowBox[{"\[Delta]1", "-", "\[Delta]2"}], ")"}]}], "-", 
        RowBox[{"\[Delta]2", " ", 
         RowBox[{"(", 
          RowBox[{"J", "+", "L", "+", 
           RowBox[{"S2", " ", "\[Sigma]2"}]}], ")"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"r", "[", "t", "]"}], "3"]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8621276427651377`*^9, 3.862127661918027*^9}, {
   3.862127700367592*^9, 3.862127726449209*^9}, 3.8621287945950813`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"08a160d1-c651-4f54-9346-d5425f20b1a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"L", " ", 
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"3", " ", "\[Nu]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "SeffdLinit"}], "+", 
          RowBox[{
           SuperscriptBox["Lninit", "2"], " ", "\[Nu]"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(*", 
         SuperscriptBox[
          RowBox[{"r", "[", "t", "]"}], "5"], "*)"}]}]]}], "IntReciOfr5"}], 
    "+", 
    RowBox[{
     FractionBox[
      RowBox[{"Lninit", " ", 
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "6"}], "+", 
         RowBox[{"17", " ", "\[Nu]"}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}], 
      RowBox[{"2", 
       RowBox[{"(*", " ", 
        SuperscriptBox[
         RowBox[{"r", "[", "t", "]"}], "4"], "*)"}]}]], "IntReciOfr4"}], "-", 
    
    RowBox[{
     FractionBox[
      RowBox[{"\[Epsilon]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "SeffdLinit"}], "+", 
         RowBox[{
          SuperscriptBox["L", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"4", "+", "\[Delta]1", "+", "\[Delta]2", "+", 
            RowBox[{"4", " ", "Hinit", " ", "\[Epsilon]"}], "-", 
            RowBox[{"2", " ", "\[Nu]"}], "-", 
            RowBox[{"13", " ", "Hinit", " ", "\[Epsilon]", " ", "\[Nu]"}], 
            "+", 
            RowBox[{"3", " ", "Hinit", " ", "\[Epsilon]", " ", 
             SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}], "+", 
         RowBox[{"L", " ", "S2", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], 
        ")"}]}], 
      RowBox[{"L", " ", 
       RowBox[{"(*", 
        SuperscriptBox[
         RowBox[{"r", "[", "t", "]"}], "3"], "*)"}]}]], "IntReciOfr3"}], "+", 
    
    RowBox[{
     FractionBox[
      RowBox[{"L", " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{
          SuperscriptBox["Hinit", "2"], " ", 
          SuperscriptBox["\[Epsilon]", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"3", " ", "\[Nu]"}]}], ")"}], "2"]}], "+", 
         RowBox[{"2", " ", "Hinit", " ", "\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"3", " ", "\[Nu]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"(*", 
        SuperscriptBox[
         RowBox[{"r", "[", "t", "]"}], "2"], "*)"}]}]], "IntReciOfr2"}]}], 
   "  ", "/.", 
   RowBox[{"L", "->", "Lninit"}]}], " ", "/.", 
  RowBox[{"S2", "->", "S2ninit"}]}]], "Input",
 CellChangeTimes->{{3.8621287604690027`*^9, 3.862128858456058*^9}, {
  3.862129399353161*^9, 3.862129412391531*^9}, {3.8621294981284103`*^9, 
  3.862129505103567*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"5a514791-ffcf-4ac7-b027-d8f7772a5e79"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", "IntReciOfr5", " ", "Lninit", " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"3", " ", "\[Nu]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "SeffdLinit"}], "+", 
     RowBox[{
      SuperscriptBox["Lninit", "2"], " ", "\[Nu]"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "IntReciOfr4", " ", "Lninit", " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "6"}], "+", 
     RowBox[{"17", " ", "\[Nu]"}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "IntReciOfr2", " ", "Lninit", " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     RowBox[{
      SuperscriptBox["Hinit", "2"], " ", 
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"3", " ", "\[Nu]"}]}], ")"}], "2"]}], "+", 
     RowBox[{"2", " ", "Hinit", " ", "\[Epsilon]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"3", " ", "\[Nu]"}]}], ")"}]}]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"IntReciOfr3", " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "SeffdLinit"}], "+", 
      RowBox[{
       SuperscriptBox["Lninit", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "\[Delta]1", "+", "\[Delta]2", "+", 
         RowBox[{"4", " ", "Hinit", " ", "\[Epsilon]"}], "-", 
         RowBox[{"2", " ", "\[Nu]"}], "-", 
         RowBox[{"13", " ", "Hinit", " ", "\[Epsilon]", " ", "\[Nu]"}], "+", 
         RowBox[{"3", " ", "Hinit", " ", "\[Epsilon]", " ", 
          SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}], "+", 
      RowBox[{
      "Lninit", " ", "S2ninit", " ", "\[Delta]2", " ", "\[Sigma]2"}]}], 
     ")"}]}], "Lninit"]}]], "Output",
 CellChangeTimes->{{3.862128792222601*^9, 3.862128815424219*^9}, {
   3.862128846604945*^9, 3.8621288589549513`*^9}, 3.862129413973082*^9, 
   3.862129505769162*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"407c5274-2f9b-4a46-92fd-0a9bc31643ee"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.862131063949457*^9, 3.862131066032378*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"e67d3e76-2e72-4d1e-a157-f5174287a820"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

P vector calculation\
\>", "Subsection",
 CellChangeTimes->{{3.862131071721511*^9, 
  3.8621310936610394`*^9}},ExpressionUUID->"48a5c9c5-d63c-43d9-8884-\
7bf99185a968"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"EulMatItoNI", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}], ",", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}], ",", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}]}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], ",", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]1", "[", "t", "]"}], "]"}]}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], ",", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}]}], "}"}]}], "}"}]}], "    ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LvecNI", " ", "=", " ", 
   RowBox[{"L", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S1vecNI", "=", 
   RowBox[{"S1", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Xi]3", "[", "t", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Xi]3", "[", "t", "]"}], "]"}]}], ",", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}]}], "}"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S2vecNI", "=", 
   RowBox[{"S2", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"\[Xi]3", "[", "t", "]"}], "+", 
         RowBox[{"\[CapitalDelta]\[Psi]", "[", "t", "]"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"\[Xi]3", "[", "t", "]"}], "+", 
         RowBox[{"\[CapitalDelta]\[Psi]", "[", "t", "]"}]}], "]"}]}], ",", 
      " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}]}], "}"}]}]}], "  ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SeffNI", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Delta]1", " ", "S1vecNI"}], "+", 
     RowBox[{"\[Delta]2", " ", "S2vecNI"}]}], ")"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rVecNI", " ", "=", " ", 
   RowBox[{
    RowBox[{"r", "[", "t", "]"}], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}], ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}], ",", "0"}], "}"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pVecNI", " ", "=", " ", 
   RowBox[{
    RowBox[{"p", "[", "t", "]"}], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}], ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}], ",", "0"}], "}"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pVecI", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Inverse", "[", "EulMatItoNI", "]"}], ".", "pVecNI"}], "      ", 
    "//", "Simplify"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{"dpVecdtNI", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"EulMatItoNI", ".", 
     RowBox[{"D", "[", 
      RowBox[{"pVecI", ",", "t"}], "]"}]}], "  ", "//", "Simplify"}], "   ", "//",
    "TableForm"}]}]}], "Input",
 CellChangeTimes->{{3.862135027670084*^9, 3.862135123324136*^9}, {
  3.8621351742578573`*^9, 3.8621351757962418`*^9}, {3.862135384069209*^9, 
  3.862135390918227*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"474be403-4690-4403-9f22-1e09247b7e5b"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["p", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "-", 
       RowBox[{
        RowBox[{"p", "[", "t", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["\[Xi]1", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Phi]2", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["p", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}], " ", 
        RowBox[{"p", "[", "t", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}], " ", 
           RowBox[{
            SuperscriptBox["\[Xi]1", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Phi]2", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{"p", "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}]}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Xi]2", "[", "t", "]"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Xi]1", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["\[Xi]2", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8621353854862967`*^9, 3.862135393413994*^9}},
 CellLabel->
  "Out[47]//TableForm=",ExpressionUUID->"fe309bbb-0a57-4dc2-996d-\
f6e35c51ad08"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dpvecdt", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["rVecNI", 
         SuperscriptBox["R", "3"]]}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", " ", 
          SuperscriptBox["R", "5"]}]], 
        InterpretationBox[
         StyleBox["\[Epsilon]",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`\[Epsilon],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", 
           InterpretationBox[
            StyleBox["\[Nu]",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`\[Nu],
            Editable->False], " ", "rVecNI", " ", 
           SuperscriptBox["pdr", "2"]}], "+", 
          RowBox[{"2", " ", "rVecNI", " ", "R"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "-", 
             InterpretationBox[
              StyleBox["\[Nu]",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`\[Nu],
              Editable->False]}], ")"}], " ", "rVecNI", " ", 
           SuperscriptBox["P", "2"], " ", 
           SuperscriptBox["R", "2"]}], "+", 
          RowBox[{"6", " ", "rVecNI", " ", "SeffdL"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["R", "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              InterpretationBox[
               StyleBox["\[Nu]",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`\[Nu],
               Editable->False], " ", "pVecNI", "  ", "pdr"}], "-", " ", 
             RowBox[{"Cross", "[", 
              RowBox[{"pVecNI", ",", "SeffNI"}], "]"}]}], ")"}]}]}], 
         ")"}]}]}], " ", "/.", 
      RowBox[{"R", "->", 
       RowBox[{"r", "[", "t", "]"}]}]}], "/.", 
     RowBox[{"P", "->", 
      RowBox[{"p", "[", "t", "]"}]}]}], " ", "//", "Simplify"}], " ", "//", 
   "TableForm"}]}]], "Input",
 CellChangeTimes->{{3.862131096013579*^9, 3.862131157180028*^9}, {
  3.862134593339217*^9, 3.862134714431286*^9}, {3.8621347939226503`*^9, 
  3.8621348387500553`*^9}, {3.862135222479383*^9, 3.8621352747500477`*^9}, {
  3.862135342173025*^9, 3.8621353649466476`*^9}, {3.862135394975087*^9, 
  3.862135397097888*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"18f28028-ed40-4fd6-92c7-2c89bc93cf86"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      FractionBox[
       RowBox[{
        RowBox[{"3", " ", "\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "SeffdL"}], "-", 
           RowBox[{
            SuperscriptBox["pdr", "2"], " ", "\[Nu]"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"\[Epsilon]", " ", 
            RowBox[{"(", 
             RowBox[{"3", "+", "\[Nu]"}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"p", "[", "t", "]"}], "2"]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"r", "[", "t", "]"}], "2"]}], "+", 
        RowBox[{"2", " ", "\[Epsilon]", " ", 
         RowBox[{"r", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"p", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"pdr", " ", "\[Nu]", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"S1", " ", "\[Delta]1", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}]}], "+", 
                 RowBox[{"S2", " ", "\[Delta]2", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}]}]}], ")"}], 
               " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
          ")"}]}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"r", "[", "t", "]"}], "4"]}]]},
     {
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Epsilon]"}], " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", "\[Nu]"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"p", "[", "t", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"r", "[", "t", "]"}], "2"], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"6", " ", "SeffdL", " ", "\[Epsilon]"}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["pdr", "2"], " ", "\[Epsilon]", " ", "\[Nu]"}], 
           "+", 
           RowBox[{"2", " ", "\[Epsilon]", " ", 
            RowBox[{"r", "[", "t", "]"}]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"r", "[", "t", "]"}], "2"]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"2", " ", "\[Epsilon]", " ", 
         RowBox[{"p", "[", "t", "]"}], " ", 
         RowBox[{"r", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"S1", " ", "\[Delta]1", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"S2", " ", "\[Delta]2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"pdr", " ", "\[Nu]", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"r", "[", "t", "]"}], "4"]}]]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"p", "[", "t", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"S1", " ", "\[Delta]1", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Xi]3", "[", "t", "]"}], "]"}]}], "+", 
              RowBox[{"S2", " ", "\[Delta]2", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"\[CapitalDelta]\[Psi]", "[", "t", "]"}], "+", 
                 RowBox[{"\[Xi]3", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"S1", " ", "\[Delta]1", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Xi]3", "[", "t", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Kappa]1", "[", "t", "]"}], "]"}]}], "+", 
              RowBox[{"S2", " ", "\[Delta]2", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 RowBox[{"\[CapitalDelta]\[Psi]", "[", "t", "]"}], "+", 
                 RowBox[{"\[Xi]3", "[", "t", "]"}]}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Kappa]2", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "t", "]"}], "]"}]}]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"r", "[", "t", "]"}], "3"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.862131154457449*^9, 3.8621311575428677`*^9}, 
   3.862134839854398*^9, {3.862135339934731*^9, 3.8621353662844563`*^9}, 
   3.8621353974470673`*^9},
 CellLabel->
  "Out[48]//TableForm=",ExpressionUUID->"6207b075-89f5-4088-98f9-\
88dc2f717850"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.862131185577881*^9, 3.862131215927031*^9}, {
   3.862131255634948*^9, 3.86213130821633*^9}, {3.862131495149562*^9, 
   3.862131501497607*^9}, 3.8621345898309927`*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"e795d036-5663-4de0-917a-5a7ec04870f6"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.862131468880369*^9, 3.862131472172991*^9}, {
   3.862131505238134*^9, 3.8621315153130713`*^9}, {3.862131885681683*^9, 
   3.862131898867382*^9}, {3.862131947322905*^9, 3.862131952470716*^9}, {
   3.862132040806077*^9, 3.862132076168124*^9}, 3.8621345861542473`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"b4f5583b-ac16-447a-af91-eed01b228943"]
}, Open  ]]
},
WindowSize->{1920, 1027},
WindowMargins->{{1864, Automatic}, {Automatic, 208}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1.5 Inherited,
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"425819d6-a98f-406f-8a4a-7ab8e1863bbb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 252, 4, 81, "Subsection",ExpressionUUID->"9b84d41c-29e1-42fd-b58e-c4db06445d14"],
Cell[835, 28, 4828, 133, 348, "Input",ExpressionUUID->"d00c22de-cfc1-492a-8ab8-b069738dc2f1"],
Cell[CellGroupData[{
Cell[5688, 165, 6548, 174, 432, "Input",ExpressionUUID->"d7032432-7e05-4db2-91a3-2c97b114b295"],
Cell[12239, 341, 3173, 77, 103, "Output",ExpressionUUID->"4ed61868-0087-4673-a1d8-b0d72ebfe3c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15449, 423, 4027, 113, 196, "Input",ExpressionUUID->"82d5e006-f302-4e95-8d78-a795d1d7ff70"],
Cell[19479, 538, 486, 7, 69, "Output",ExpressionUUID->"274f4989-c099-4f26-8bb0-86f4e9028f62"]
}, Open  ]],
Cell[19980, 548, 216, 4, 46, "Input",ExpressionUUID->"d1a24233-497a-4de5-892f-3df587eaca2a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20233, 557, 252, 4, 81, "Subsection",ExpressionUUID->"791a297d-5917-4755-9b4f-33e331774aaf"],
Cell[CellGroupData[{
Cell[20510, 565, 3724, 103, 421, "Input",ExpressionUUID->"104acd6d-3292-4329-8641-7d2236c3ba57"],
Cell[24237, 670, 2195, 59, 103, "Output",ExpressionUUID->"74e3c2a5-1255-4c56-a56b-6cc082747493"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26469, 734, 4016, 115, 196, "Input",ExpressionUUID->"2490f233-051e-46d3-9125-4e83b272358f"],
Cell[30488, 851, 1227, 34, 96, "Output",ExpressionUUID->"f949d0af-da9b-4c61-8dc7-0d0e1506858c"]
}, Open  ]],
Cell[31730, 888, 293, 6, 46, "Input",ExpressionUUID->"3aea333f-c6e3-4c94-bba5-addf68c09a5f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32060, 899, 169, 3, 81, "Subsection",ExpressionUUID->"7f172cd1-07cd-454f-89d2-f2ae052d5e92"],
Cell[CellGroupData[{
Cell[32254, 906, 12202, 355, 1036, "Input",ExpressionUUID->"d0ba0f04-b3d5-48c6-8500-0f9e6e8b5ad2"],
Cell[44459, 1263, 251, 4, 69, "Output",ExpressionUUID->"f2fee574-6f5a-4dae-88ea-f2ef83b61a48"]
}, Open  ]],
Cell[44725, 1270, 293, 6, 46, "Input",ExpressionUUID->"bc0eead7-5904-485a-a0bb-4693e3012601"],
Cell[45021, 1278, 282, 5, 202, "Input",ExpressionUUID->"e1162ebe-4c8d-4ef0-b6e7-fccd9471eea6"],
Cell[CellGroupData[{
Cell[45328, 1287, 568, 13, 68, "Subsubsection",ExpressionUUID->"e456f7a6-1d02-4db4-bb89-be24f785c95e"],
Cell[CellGroupData[{
Cell[45921, 1304, 2518, 69, 334, "Input",ExpressionUUID->"170ba6c9-cfcf-4504-9d5b-e5acabe817c9"],
Cell[48442, 1375, 855, 23, 92, "Output",ExpressionUUID->"a97a0465-8463-4117-99cd-9657be8d978d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49334, 1403, 6430, 188, 494, "Input",ExpressionUUID->"f302f918-fc19-4700-a8f1-4d5a12c36d3d"],
Cell[55767, 1593, 1972, 52, 110, "Output",ExpressionUUID->"df090d48-2159-4e9a-be0b-1d12773ba845"]
}, Open  ]],
Cell[57754, 1648, 7777, 221, 549, "Input",ExpressionUUID->"9a0bac70-a7c0-485b-a976-6670343d5b34"],
Cell[CellGroupData[{
Cell[65556, 1873, 4583, 113, 266, "Input",ExpressionUUID->"a82846e3-06b9-41ff-9ab1-5fc4d8bfb642"],
Cell[70142, 1988, 2373, 69, 167, "Output",ExpressionUUID->"bb9c0c04-0554-498c-8ab0-19fcc942fa66"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72552, 2062, 4012, 101, 198, "Input",ExpressionUUID->"c8022341-1c59-40d6-9cd7-45e9c8c56cc6"],
Cell[76567, 2165, 2729, 63, 167, "Output",ExpressionUUID->"0fc221e3-96f3-4581-85ba-4adeaaf370ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79333, 2233, 4471, 125, 338, "Input",ExpressionUUID->"6f2cbbd2-ca4a-4f94-90ec-cb506ffd281c"],
Cell[83807, 2360, 3839, 100, 142, "Output",ExpressionUUID->"08a160d1-c651-4f54-9346-d5425f20b1a3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87683, 2465, 3060, 88, 229, "Input",ExpressionUUID->"5a514791-ffcf-4ac7-b027-d8f7772a5e79"],
Cell[90746, 2555, 2238, 60, 199, "Output",ExpressionUUID->"407c5274-2f9b-4a46-92fd-0a9bc31643ee"]
}, Open  ]],
Cell[92999, 2618, 214, 4, 46, "Input",ExpressionUUID->"e67d3e76-2e72-4d1e-a157-f5174287a820"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[93262, 2628, 179, 6, 122, "Subsection",ExpressionUUID->"48a5c9c5-d63c-43d9-8884-7bf99185a968"],
Cell[CellGroupData[{
Cell[93466, 2638, 4591, 134, 326, "Input",ExpressionUUID->"474be403-4690-4403-9f22-1e09247b7e5b"],
Cell[98060, 2774, 2923, 84, 160, "Output",ExpressionUUID->"fe309bbb-0a57-4dc2-996d-f6e35c51ad08"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101020, 2863, 2529, 69, 139, "Input",ExpressionUUID->"18f28028-ed40-4fd6-92c7-2c89bc93cf86"],
Cell[103552, 2934, 6392, 163, 188, "Output",ExpressionUUID->"6207b075-89f5-4088-98f9-88dc2f717850"]
}, Open  ]],
Cell[109959, 3100, 293, 4, 46, "Input",ExpressionUUID->"e795d036-5663-4de0-917a-5a7ec04870f6"],
Cell[110255, 3106, 392, 5, 46, "Input",ExpressionUUID->"b4f5583b-ac16-447a-af91-eed01b228943"]
}, Open  ]]
}
]
*)

