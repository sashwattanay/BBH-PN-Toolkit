(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12480,        328]
NotebookOptionsPosition[     11100,        298]
NotebookOutlinePosition[     11620,        317]
CellTagsIndexPosition[     11577,        314]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8457349625739365`*^9, 3.8457349649960003`*^9}, {
  3.860801828822962*^9, 3.8608018295844307`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"04aa2243-eedc-450d-a6a9-9a729241d033"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8541093532526817`*^9, 3.8541093777693543`*^9}, 
   3.8547709980818434`*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"f6eef687-c05f-46ce-b69b-0072132d8f93"],

Cell[CellGroupData[{

Cell["Initial conditions", "Title",
 CellChangeTimes->{{3.8604604993059244`*^9, 
  3.860460503471142*^9}},ExpressionUUID->"c28aa2a7-d21e-426d-960c-\
e1f494daa54f"],

Cell["unrescaled quantities", "Title",
 CellChangeTimes->{{3.860798770096822*^9, 3.860798775584608*^9}, 
   3.8608029634041452`*^9},ExpressionUUID->"93e68de5-0837-4f20-899e-\
f3a3d61b9519"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "we", " ", "keep", " ", "the", " ", "same", " ", "values", " ", "for", " ", 
   "unrescaled", " ", "quantities", " ", "as", " ", "the", " ", "numerical", 
   " ", "solution", " ", "notebook", " ", "for", " ", "matching"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8608001569208097`*^9, 3.86080017822126*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"b4bce99e-c48b-4c62-b18f-f1b511f509a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Rinit", "=", 
    RowBox[{"{", 
     RowBox[{"0.1", ",", "0.3", ",", "0"}], "}"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pinit", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], ";"}], 
  "   "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S1init", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S2init", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "0.3"}], ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m1N", "=", "1.5"}], ";", 
   RowBox[{"m2N", "=", "1"}], ";", 
   RowBox[{"G", "=", "1"}], ";", 
   RowBox[{"\[Epsilon]N", "=", ".001"}], " ", ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", " ", "=", " ", 
   RowBox[{"m1", "+", "m2"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]", " ", "=", " ", 
   RowBox[{"m1", " ", 
    RowBox[{"m2", "/", "M"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]1", "=", 
   RowBox[{"2", " ", "m1", " ", 
    FractionBox["m2", 
     SuperscriptBox["M", "2"]], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       FractionBox["3", "4"], " ", 
       FractionBox["m2", "m1"]}]}], ")"}]}]}], "  ", ";", "   ", 
  RowBox[{"\[Delta]2", "=", 
   RowBox[{"2", " ", "m2", " ", 
    FractionBox["m1", 
     SuperscriptBox["M", "2"]], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       FractionBox["3", "4"], " ", 
       FractionBox["m1", "m2"]}]}], ")"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Rx", ",", " ", "Ry", ",", "Rz"}], "}"}]}], " ", ";", " ", 
  RowBox[{"P", " ", "=", 
   RowBox[{"{", 
    RowBox[{"Px", ",", "Py", ",", "Pz"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S1", "=", " ", 
   RowBox[{"{", 
    RowBox[{"S1x", ",", " ", "S1y", ",", "S1z"}], "}"}]}], " ", ";", "    ", 
  RowBox[{"S2", "=", " ", 
   RowBox[{"{", 
    RowBox[{"S2x", ",", " ", "S2y", ",", "S2z"}], "}"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S1n", " ", "=", " ", 
   RowBox[{"Norm", "[", "S1", "]"}]}], " ", ";", "     ", 
  RowBox[{"S2n", " ", "=", " ", 
   RowBox[{"Norm", "[", "S2", "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Seff", "=", " ", 
   RowBox[{
    RowBox[{"\[Delta]1", " ", "S1Vec"}], "+", " ", 
    RowBox[{"\[Delta]2", " ", "S2Vec"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8604605495801725`*^9, 3.860460726428547*^9}, {
   3.860467799555441*^9, 3.8604678211564703`*^9}, {3.860467987665392*^9, 
   3.860467996942706*^9}, {3.8604682265398026`*^9, 3.8604682334552746`*^9}, 
   3.860468322972333*^9, {3.8604683674289546`*^9, 3.860468372689849*^9}, {
   3.8607975052376165`*^9, 3.8607975401549788`*^9}, {3.8607976178733873`*^9, 
   3.860797654782824*^9}, {3.8607978998783436`*^9, 3.860797901432599*^9}, {
   3.86079818777748*^9, 3.8607981999666576`*^9}, {3.8607985810546837`*^9, 
   3.8607985814809246`*^9}, {3.8607986212369843`*^9, 3.860798750618828*^9}, {
   3.8607987820510435`*^9, 3.860798791699768*^9}, {3.860798835914669*^9, 
   3.8607988482851133`*^9}, {3.860798885798452*^9, 3.86079897354749*^9}, 
   3.8607998413832517`*^9, 3.8607998971896453`*^9, {3.860799972669767*^9, 
   3.860800008290717*^9}, {3.860800198037237*^9, 3.860800198421895*^9}, {
   3.860800535574095*^9, 3.86080055044881*^9}, {3.860801186909719*^9, 
   3.8608013985523853`*^9}, {3.86080143384153*^9, 3.860801529065855*^9}, {
   3.860801560894085*^9, 3.860801569284627*^9}, {3.8608016956566973`*^9, 
   3.860801717073454*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"46ca37b3-b282-4e19-bd6f-d7095dd05190"]
}, Open  ]],

Cell[CellGroupData[{

Cell["scaled quantities", "Title",
 CellChangeTimes->{{3.860798799713297*^9, 3.860798805613183*^9}, {
   3.860800333704401*^9, 3.860800334213153*^9}, 
   3.860801802142536*^9},ExpressionUUID->"8bf94fac-22e2-4784-acf9-\
5f08ab157fb8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"r", "=", 
   FractionBox["R", 
    RowBox[{"G", " ", "M"}]]}], ";", "       ", 
  RowBox[{"p", "=", 
   FractionBox["P", "\[Mu]"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "=", 
    RowBox[{"Cross", "[", 
     RowBox[{"r", ",", "p"}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Conserved", " ", "quantities", " ", "defined", " ", "in", " ", "terms", 
    " ", "of", " ", "scaled", " ", "variables"}], "*)"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ln", "=", 
   RowBox[{"Norm", "[", "L", "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jn", "=", 
   RowBox[{"Norm", "[", 
    RowBox[{"L", "+", "S1", "+", "S2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SeffL", "=", " ", 
   RowBox[{"Seff", ".", "L"}]}], " ", ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8607996929357767`*^9, 3.8607999699816437`*^9}, {
  3.860800021144076*^9, 3.8608000568965836`*^9}, {3.8608001037497225`*^9, 
  3.860800103994295*^9}, {3.860800349638486*^9, 3.8608003498450775`*^9}, {
  3.8608014672969837`*^9, 3.860801467444021*^9}, {3.860801531130434*^9, 
  3.860801635700654*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"f4d4d1a4-7946-47d7-a23b-ad0948e5193b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Rx", ",", "Ry", ",", "Rz"}], "}"}], " ", "=", " ", "Rinit"}], 
  "  ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Px", ",", "Py", ",", "Pz"}], "}"}], "=", "Pinit"}], "  ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"S1x", ",", "S1y", ",", "S1z"}], "}"}], " ", "=", " ", 
    "S1init"}], " ", ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"S2x", ",", "S2y", ",", "S2z"}], "}"}], " ", "=", " ", "S2init"}],
   "  ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m1", " ", "=", " ", "m1N"}], " ", ";", " ", 
   RowBox[{"m2", " ", "=", " ", "m2N"}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]1N", "=", 
    RowBox[{
     FractionBox[
      RowBox[{"S1", ".", "S2"}], 
      RowBox[{"S1n", " ", "S2n"}]], " ", "-", 
     RowBox[{
      FractionBox["Ln", "S2n"], 
      FractionBox[
       RowBox[{"\[Delta]1", "-", "\[Delta]2"}], "\[Delta]2"], 
      FractionBox[
       RowBox[{" ", 
        RowBox[{"S1", ".", "L"}]}], 
       RowBox[{"Ln", " ", "S1n"}]]}]}]}], "   ", ";", "     ", 
   RowBox[{"(*", 
    RowBox[{"\[Sigma]1", "=", 
     RowBox[{
      RowBox[{"Cos", " ", "\[Gamma]"}], " ", "-", 
      RowBox[{
       FractionBox["L", "S2"], 
       FractionBox[
        RowBox[{"Q1", "-", "Q2"}], "Q2"], "Cos", " ", "\[Kappa]1"}]}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"\[Sigma]2N", "=", " ", 
    RowBox[{
     FractionBox[
      RowBox[{" ", 
       RowBox[{"S2", ".", "L"}]}], 
      RowBox[{"Ln", " ", "S2n"}]], " ", "+", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"\[Delta]1", " ", "S1n"}], 
       RowBox[{"\[Delta]2", " ", "S2n"}]], 
      FractionBox[
       RowBox[{" ", 
        RowBox[{"S1", ".", "L"}]}], 
       RowBox[{"Ln", " ", "S1n"}]]}]}]}], "       ", ";"}], "            ", 
  RowBox[{"(*", 
   RowBox[{"\[Sigma]2", "=", " ", 
    RowBox[{
     RowBox[{"Cos", " ", "\[Kappa]2"}], " ", "+", 
     RowBox[{
      FractionBox[
       RowBox[{"Q1", " ", "S1"}], 
       RowBox[{"Q2", " ", "S2"}]], " ", "Cos", " ", "\[Kappa]1"}]}]}], "*)"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{
  "Rx", ",", " ", "Ry", ",", " ", "Rz", ",", " ", "Px", ",", " ", "Py", ",", 
   " ", "Pz", ",", " ", "S1x", ",", " ", "S1y", ",", " ", "S1z", ",", " ", 
   "S2x", ",", " ", "S2y", ",", " ", "S2z", ",", " ", "m1", ",", " ", "m2"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.860797690031384*^9, 3.860797719561613*^9}, {
  3.860797756603367*^9, 3.860797803292447*^9}, {3.860797915436698*^9, 
  3.8607980059837856`*^9}, {3.860798293481518*^9, 3.8607984969414787`*^9}, {
  3.860799106816284*^9, 3.860799115116769*^9}, {3.8607996225317345`*^9, 
  3.8607996598605776`*^9}, {3.860800399686261*^9, 3.8608004125848274`*^9}, {
  3.860800514522456*^9, 3.8608005157551394`*^9}, {3.8608016757038527`*^9, 
  3.860801687143568*^9}, {3.8608017232786903`*^9, 3.860801792648574*^9}, {
  3.860801846973364*^9, 3.8608018508516407`*^9}, {3.8608019184948606`*^9, 
  3.860801920766818*^9}, {3.860802715745249*^9, 3.8608027375132113`*^9}, {
  3.860802816654847*^9, 3.860802910538534*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"b679f6b1-cc78-4998-b53c-e65093b74335"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.860801866841*^9, 3.8608019005351543`*^9}, {
  3.8608019328638783`*^9, 3.8608019353564167`*^9}, {3.8608025240352087`*^9, 
  3.860802570213932*^9}, {3.8608026650147667`*^9, 3.860802751387946*^9}, {
  3.860802792850955*^9, 3.8608027930181704`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"5c022dbf-49c3-43b6-b006-1e110065d441"]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
Magnification:>1.5 Inherited,
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"21467c99-2b65-4a6b-a1a8-32689b407aa1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 225, 3, 46, "Input",ExpressionUUID->"04aa2243-eedc-450d-a6a9-9a729241d033"],
Cell[786, 25, 202, 3, 46, "Input",ExpressionUUID->"f6eef687-c05f-46ce-b69b-0072132d8f93"],
Cell[CellGroupData[{
Cell[1013, 32, 163, 3, 146, "Title",ExpressionUUID->"c28aa2a7-d21e-426d-960c-e1f494daa54f"],
Cell[1179, 37, 189, 3, 146, "Title",ExpressionUUID->"93e68de5-0837-4f20-899e-f3a3d61b9519"],
Cell[1371, 42, 431, 8, 46, "Input",ExpressionUUID->"b4bce99e-c48b-4c62-b18f-f1b511f509a4"],
Cell[1805, 52, 3869, 99, 480, "Input",ExpressionUUID->"46ca37b3-b282-4e19-bd6f-d7095dd05190"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5711, 156, 233, 4, 146, "Title",ExpressionUUID->"8bf94fac-22e2-4784-acf9-5f08ab157fb8"],
Cell[5947, 162, 1356, 34, 323, "Input",ExpressionUUID->"f4d4d1a4-7946-47d7-a23b-ad0948e5193b"],
Cell[7306, 198, 3402, 90, 383, "Input",ExpressionUUID->"b679f6b1-cc78-4998-b53c-e65093b74335"],
Cell[10711, 290, 373, 5, 46, "Input",ExpressionUUID->"5c022dbf-49c3-43b6-b006-1e110065d441"]
}, Open  ]]
}
]
*)

