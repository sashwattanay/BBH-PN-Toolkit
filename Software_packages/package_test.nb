(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47566,       1199]
NotebookOptionsPosition[     43600,       1128]
NotebookOutlinePosition[     44094,       1146]
CellTagsIndexPosition[     44051,       1143]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.861806462835576*^9, 3.861806464777767*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"8d37321c-5352-44b5-807b-da66489eb0e9"],

Cell[BoxData[
 RowBox[{"<<", "pkg`"}]], "Input",
 CellChangeTimes->{{3.861887049380993*^9, 3.861887052471574*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"9c9a7de7-211b-440d-976f-f2bae9225fac"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.862998238626583*^9, 3.8629982956026015`*^9}, 
   3.8630944953869596`*^9},ExpressionUUID->"7e913ad4-b4bf-416a-8834-\
d778b43a185a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m1", "=", 
   RowBox[{"5", "/", "2"}]}], ";", 
  RowBox[{"m2", "=", "1"}], ";", " ", 
  RowBox[{"\[Lambda]i", "=", "0"}], ";", 
  RowBox[{"\[Lambda]f", "=", "2"}], ";", " ", 
  RowBox[{"\[Epsilon]", "=", 
   RowBox[{"3", "/", "1000"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rinit", "=", 
   RowBox[{"2", 
    RowBox[{"{", " ", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pinit", "=", 
   RowBox[{"1", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "/", "2"}], ",", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "2"}], ",", 
      RowBox[{"1", "/", "3"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S1init", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "1"}], "}"}], 
    RowBox[{"N", "[", 
     SqrtBox[
      FractionBox["3", "1000"]], " ", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S2init", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{
        RowBox[{"-", "3"}], "/", "10"}], ",", "0"}], "}"}], 
     RowBox[{"N", "[", 
      SqrtBox[
       FractionBox["3", "1000"]], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"end", " ", "of", " ", "user", " ", "supplied", "  ", "data"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8628410603909597`*^9, 3.8628411741358533`*^9}, {
   3.86284125968686*^9, 3.862841292249702*^9}, {3.862841364063359*^9, 
   3.862841382950398*^9}, {3.862841413586178*^9, 3.862841587561248*^9}, {
   3.862841645622574*^9, 3.8628418040400343`*^9}, {3.8628418411185756`*^9, 
   3.8628418594003344`*^9}, 3.8628419024226217`*^9, {3.8628419344885073`*^9, 
   3.862842117048496*^9}, {3.862842162052665*^9, 3.8628422512752686`*^9}, {
   3.8628424038631086`*^9, 3.86284243152418*^9}, 3.862842552404628*^9, 
   3.8628425862873197`*^9, {3.8628765078474493`*^9, 3.862876587292898*^9}, {
   3.862876920351966*^9, 3.8628769704549937`*^9}, {3.862905444532591*^9, 
   3.862905451131959*^9}, {3.862905542367817*^9, 3.8629055428398294`*^9}, {
   3.8629055876556516`*^9, 3.8629055951440516`*^9}, {3.86290905707452*^9, 
   3.8629090703701334`*^9}, 3.862971620769506*^9, 3.862971751811206*^9, 
   3.862971988024723*^9, 3.862997705449867*^9, {3.8629977628306513`*^9, 
   3.8629977658282833`*^9}, 3.862998317834367*^9, {3.862998365373783*^9, 
   3.862998368406184*^9}, 3.862998426608635*^9, {3.8629985998353825`*^9, 
   3.8629986171664248`*^9}, 3.8630035985389147`*^9, {3.8630898286716504`*^9, 
   3.86308983264005*^9}, {3.863089887039736*^9, 3.8630899000745907`*^9}, {
   3.8630902555493193`*^9, 3.8630902710722213`*^9}, {3.8630917370914097`*^9, 
   3.86309173792627*^9}, {3.863091854175434*^9, 3.8630918548079395`*^9}, {
   3.863091938875245*^9, 3.863091943348394*^9}, {3.8630933135195684`*^9, 
   3.863093318671597*^9}, {3.8630942066750097`*^9, 3.8630942781384478`*^9}, {
   3.8630943413112583`*^9, 3.8630943814704185`*^9}, {3.8630944898150964`*^9, 
   3.8630945267078643`*^9}, {3.863095159671672*^9, 3.863095163929612*^9}, {
   3.8631429681076784`*^9, 3.8631430477571306`*^9}, {3.8631758676803837`*^9, 
   3.863175898502027*^9}, {3.8632558893929415`*^9, 3.863255907742674*^9}, {
   3.8632569397357907`*^9, 3.8632570216102505`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"a80f7c21-dda8-44c7-bff5-b3529c14f117"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SeffLflow", "[", 
     RowBox[{
     "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", 
      "S2init", ",", "\[Lambda]f", ",", "\[Lambda]i", ",", "\[Epsilon]"}], 
     "]"}], "-", 
    RowBox[{"NmSeffLflow", "[", 
     RowBox[{
     "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", 
      "S2init", ",", "\[Lambda]f", ",", "\[Lambda]i", ",", "\[Epsilon]"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Jflow", "[", 
     RowBox[{
     "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", 
      "S2init", ",", "\[Lambda]f", ",", "\[Lambda]i", ",", "\[Epsilon]"}], 
     "]"}], "-", 
    RowBox[{"NmJflow", "[", 
     RowBox[{
     "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", 
      "S2init", ",", "\[Lambda]f", ",", "\[Lambda]i", ",", "\[Epsilon]"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lflow", "[", 
     RowBox[{
     "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", 
      "S2init", ",", "\[Lambda]f", ",", "\[Lambda]i", ",", "\[Epsilon]"}], 
     "]"}], "-", " ", 
    RowBox[{"NmLflow", "[", 
     RowBox[{
     "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", 
      "S2init", ",", "\[Lambda]f", ",", "\[Lambda]i", ",", "\[Epsilon]"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Jzflow", "[", 
     RowBox[{
     "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", 
      "S2init", ",", "\[Lambda]f", ",", "\[Lambda]i", ",", "\[Epsilon]"}], 
     "]"}], "-", 
    RowBox[{"NmJzflow", "[", 
     RowBox[{
     "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", 
      "S2init", ",", "\[Lambda]f", ",", "\[Lambda]i", ",", "\[Epsilon]"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hflow", "[", 
     RowBox[{
     "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", 
      "S2init", ",", "\[Lambda]f", ",", "\[Lambda]i", ",", "\[Epsilon]"}], 
     "]"}], "-", 
    RowBox[{"NmHflow", "[", 
     RowBox[{
     "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", 
      "S2init", ",", "\[Lambda]f", ",", "\[Lambda]i", ",", "\[Epsilon]"}], 
     "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8627486185265617`*^9, 3.862748628384763*^9}, 
   3.8627521891428595`*^9, {3.862819313131895*^9, 3.8628193579284205`*^9}, {
   3.8628194631824784`*^9, 3.8628194733849764`*^9}, {3.862821228975334*^9, 
   3.8628212353975377`*^9}, {3.862834425756391*^9, 3.862834473918357*^9}, {
   3.862834629382636*^9, 3.862834636477192*^9}, {3.8628350915046606`*^9, 
   3.862835132346295*^9}, {3.8628352120040846`*^9, 3.8628352556320457`*^9}, {
   3.8628353047361975`*^9, 3.8628353392112646`*^9}, {3.862840969522986*^9, 
   3.862840992032762*^9}, {3.862841135106235*^9, 3.8628411381736455`*^9}, {
   3.8628411795299516`*^9, 3.86284122277487*^9}, {3.8628413247167883`*^9, 
   3.8628413594094114`*^9}, {3.86284159261841*^9, 3.862841630101163*^9}, 
   3.8628422763090134`*^9, {3.8629977719011145`*^9, 3.8629977765496907`*^9}, {
   3.863262209061058*^9, 3.8632622383635273`*^9}, {3.863263859811516*^9, 
   3.8632638920096226`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"b03250b8-9063-4601-b1c7-36cb36b1055a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.23100762706008`*^-8"}], ",", "1.3351571159780917`*^-7", 
     ",", 
     RowBox[{"-", "5.376138334511893`*^-8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.2500258034231493`*^-7"}], ",", 
     RowBox[{"-", "7.048714723012495`*^-9"}], ",", "1.772758120854867`*^-7"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.255753044951402`*^-8", ",", 
     RowBox[{"-", "1.2117310210779664`*^-9"}], ",", 
     "1.2478485023059704`*^-8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.382626402644723`*^-7"}], ",", "6.546684497444472`*^-7", 
     ",", 
     RowBox[{"-", "1.7781235455566202`*^-7"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.863262240536867*^9, 3.863263919144334*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"44ec93a4-21b8-44a1-887e-ff01ba95ae18"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.309365712578227`*^-7"}], ",", 
     RowBox[{"-", "4.2997406746181355`*^-7"}], ",", 
     RowBox[{"-", "3.750189335391396`*^-7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "9.975126857852956`*^-8"}], ",", "8.365403741938948`*^-8", 
     ",", 
     RowBox[{"-", "7.229163490052315`*^-8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.150113366337526`*^-9"}], ",", 
     RowBox[{"-", "1.1956012811731309`*^-8"}], ",", 
     RowBox[{"-", "5.0721391739450006`*^-9"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6.4375085466299165`*^-9"}], ",", "3.2323770431108567`*^-9",
      ",", 
     RowBox[{"-", "5.079296060139793`*^-9"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.863262240536867*^9, 3.8632639196534224`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"bdfc6d0b-6157-438a-bc00-b5030606067b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.417382470338737`*^-7"}], ",", 
     RowBox[{"-", "4.7079125664595267`*^-7"}], ",", 
     RowBox[{"-", "3.6324708267698735`*^-7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.0754086410269537`*^-7"}], ",", "8.125228823097075`*^-8", 
     ",", 
     RowBox[{"-", "7.607533897280305`*^-8"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.863262240536867*^9, 3.863263919934862*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"50d3f4bf-da70-4876-9c51-28945484c243"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.439692804972026`*^-7"}], ",", "3.806703596787031`*^-8", 
     ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "9.516758991967578`*^-9", ",", "3.599232012430065`*^-8", ",", "0.`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.4926349526110947`*^-9"}], ",", 
     RowBox[{"-", "1.4501262170230067`*^-9"}], ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "7.023357208313374`*^-10"}], ",", "2.9276727916971446`*^-9",
      ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.863262240536867*^9, 3.863263919957113*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"034ab6c6-fa42-45af-aa3f-09dfc426d78c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.00035351937069139083`"}], ",", 
     RowBox[{"-", "0.0004398941179707405`"}], ",", 
     RowBox[{"-", "0.00017630615257768767`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.00007403661724181276`"}], ",", 
     RowBox[{"-", "0.00009816691298558666`"}], ",", 
     RowBox[{"-", "0.00008045187329759618`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.2293384148436285`*^-6", ",", "1.4833018281631971`*^-6", ",", 
     RowBox[{"-", "1.483464334942064`*^-6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.00006857030353530497`"}], ",", 
     RowBox[{"-", "0.00004699625998704285`"}], ",", 
     RowBox[{"-", "0.00006139060284148008`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.863262240536867*^9, 3.8632639220849695`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"22ff46fc-2501-4b80-a179-3472a4792be3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fr", "=", " ", 
   RowBox[{"frequency", "[", 
    RowBox[{
    "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", "S2init",
      ",", "\[Lambda]f", ",", "\[Lambda]i", ",", "\[Epsilon]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Energy", "=", 
  RowBox[{"fr", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"frq", "=", 
  RowBox[{"fr", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"jcm", "=", 
  RowBox[{"fr", "[", 
   RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"sfarray", "=", 
  RowBox[{"fr", "[", 
   RowBox[{"[", "4", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8628423464463205`*^9, 3.8628423471280117`*^9}, {
   3.862997828747676*^9, 3.862997829785816*^9}, {3.863261469720894*^9, 
   3.863261485494069*^9}, {3.8632617432584505`*^9, 3.863261758574238*^9}, 
   3.8632622916226125`*^9, {3.86326244080344*^9, 3.8632625747484746`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"ae6e3446-d881-43eb-b0ba-140d413a38d4"],

Cell[BoxData[
 RowBox[{"-", "0.2971173922279583`"}]], "Output",
 CellChangeTimes->{
  3.8628212661877675`*^9, 3.862821484745495*^9, 3.8628343392511983`*^9, 
   3.862835455054697*^9, 3.862842350341196*^9, 3.8628424555361786`*^9, 
   3.862909121142128*^9, 3.862909254974433*^9, 3.862911425371215*^9, 
   3.862997832430724*^9, 3.8629986635186386`*^9, 3.8629996349909925`*^9, 
   3.862999670012313*^9, 3.8630018576336813`*^9, 3.8630945502356653`*^9, 
   3.863095143778326*^9, 3.863095188309335*^9, 3.863142123424526*^9, 
   3.8631424015613956`*^9, 3.863142535579133*^9, {3.8631429192380323`*^9, 
   3.8631429274582644`*^9}, 3.8631429800001764`*^9, {3.863143031979536*^9, 
   3.8631430587271185`*^9}, 3.8631432142699966`*^9, {3.86317587420601*^9, 
   3.863175904501521*^9}, 3.863175945352582*^9, 3.863186149353108*^9, 
   3.863255937063917*^9, 3.863256192969217*^9, 3.8632564338656206`*^9, 
   3.8632570733211546`*^9, 3.8632571740163493`*^9, 3.8632590123188963`*^9, 
   3.863261380856516*^9, {3.8632614643375597`*^9, 3.863261482664138*^9}, {
   3.8632617346478786`*^9, 3.863261759708116*^9}, 3.8632622934139814`*^9, {
   3.8632625509269075`*^9, 3.8632625768468623`*^9}, 3.863263950705201*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"728986aa-80bc-4231-a57d-0396b7c9d678"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.00029818358406708066`", ",", "0.`", ",", "0.21726046523378884`", ",", 
   "0.21580477697731215`", ",", "0.000373746303279526`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8628212661877675`*^9, 3.862821484745495*^9, 3.8628343392511983`*^9, 
   3.862835455054697*^9, 3.862842350341196*^9, 3.8628424555361786`*^9, 
   3.862909121142128*^9, 3.862909254974433*^9, 3.862911425371215*^9, 
   3.862997832430724*^9, 3.8629986635186386`*^9, 3.8629996349909925`*^9, 
   3.862999670012313*^9, 3.8630018576336813`*^9, 3.8630945502356653`*^9, 
   3.863095143778326*^9, 3.863095188309335*^9, 3.863142123424526*^9, 
   3.8631424015613956`*^9, 3.863142535579133*^9, {3.8631429192380323`*^9, 
   3.8631429274582644`*^9}, 3.8631429800001764`*^9, {3.863143031979536*^9, 
   3.8631430587271185`*^9}, 3.8631432142699966`*^9, {3.86317587420601*^9, 
   3.863175904501521*^9}, 3.863175945352582*^9, 3.863186149353108*^9, 
   3.863255937063917*^9, 3.863256192969217*^9, 3.8632564338656206`*^9, 
   3.8632570733211546`*^9, 3.8632571740163493`*^9, 3.8632590123188963`*^9, 
   3.863261380856516*^9, {3.8632614643375597`*^9, 3.863261482664138*^9}, {
   3.8632617346478786`*^9, 3.863261759708116*^9}, 3.8632622934139814`*^9, {
   3.8632625509269075`*^9, 3.8632625768468623`*^9}, 3.863263950707203*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"3d1d4ed6-a923-4305-802b-3477c635e728"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`", ",", "0.`", ",", "0.`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", 
     RowBox[{"-", "1.0081033827049852`"}], ",", "4.633817721769575`", ",", 
     RowBox[{"-", "0.000423264083567126`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7978235007292319`"}], ",", "0.`", ",", 
     "0.7841159587745888`", ",", "0.`", ",", "0.24439682842399857`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8628212661877675`*^9, 3.862821484745495*^9, 3.8628343392511983`*^9, 
   3.862835455054697*^9, 3.862842350341196*^9, 3.8628424555361786`*^9, 
   3.862909121142128*^9, 3.862909254974433*^9, 3.862911425371215*^9, 
   3.862997832430724*^9, 3.8629986635186386`*^9, 3.8629996349909925`*^9, 
   3.862999670012313*^9, 3.8630018576336813`*^9, 3.8630945502356653`*^9, 
   3.863095143778326*^9, 3.863095188309335*^9, 3.863142123424526*^9, 
   3.8631424015613956`*^9, 3.863142535579133*^9, {3.8631429192380323`*^9, 
   3.8631429274582644`*^9}, 3.8631429800001764`*^9, {3.863143031979536*^9, 
   3.8631430587271185`*^9}, 3.8631432142699966`*^9, {3.86317587420601*^9, 
   3.863175904501521*^9}, 3.863175945352582*^9, 3.863186149353108*^9, 
   3.863255937063917*^9, 3.863256192969217*^9, 3.8632564338656206`*^9, 
   3.8632570733211546`*^9, 3.8632571740163493`*^9, 3.8632590123188963`*^9, 
   3.863261380856516*^9, {3.8632614643375597`*^9, 3.863261482664138*^9}, {
   3.8632617346478786`*^9, 3.863261759708116*^9}, 3.8632622934139814`*^9, {
   3.8632625509269075`*^9, 3.8632625768468623`*^9}, 3.8632639507096386`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"fbc822bb-8bbb-4a08-856c-f429f5d11b22"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.`", ",", "1.6534083130403943`*^-17", ",", 
   "0.9999999999999999`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8628212661877675`*^9, 3.862821484745495*^9, 3.8628343392511983`*^9, 
   3.862835455054697*^9, 3.862842350341196*^9, 3.8628424555361786`*^9, 
   3.862909121142128*^9, 3.862909254974433*^9, 3.862911425371215*^9, 
   3.862997832430724*^9, 3.8629986635186386`*^9, 3.8629996349909925`*^9, 
   3.862999670012313*^9, 3.8630018576336813`*^9, 3.8630945502356653`*^9, 
   3.863095143778326*^9, 3.863095188309335*^9, 3.863142123424526*^9, 
   3.8631424015613956`*^9, 3.863142535579133*^9, {3.8631429192380323`*^9, 
   3.8631429274582644`*^9}, 3.8631429800001764`*^9, {3.863143031979536*^9, 
   3.8631430587271185`*^9}, 3.8631432142699966`*^9, {3.86317587420601*^9, 
   3.863175904501521*^9}, 3.863175945352582*^9, 3.863186149353108*^9, 
   3.863255937063917*^9, 3.863256192969217*^9, 3.8632564338656206`*^9, 
   3.8632570733211546`*^9, 3.8632571740163493`*^9, 3.8632590123188963`*^9, 
   3.863261380856516*^9, {3.8632614643375597`*^9, 3.863261482664138*^9}, {
   3.8632617346478786`*^9, 3.863261759708116*^9}, 3.8632622934139814`*^9, {
   3.8632625509269075`*^9, 3.8632625768468623`*^9}, 3.863263950710306*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"34efdea6-8251-4a31-a48d-327c9f5c7c63"]
}, Open  ]],

Cell[CellGroupData[{

Cell["check action J, Jz, L close loop", "Title",
 CellChangeTimes->{{3.8632562090987597`*^9, 3.863256221495408*^9}, {
  3.863257758433608*^9, 
  3.8632577981658173`*^9}},ExpressionUUID->"eb7e98c3-1c49-49e6-b68f-\
b986127b514b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Rinit", ",", "Pinit", ",", "S1init", ",", "S2init"}], "}"}], "-", 
   RowBox[{"Jflow", "[", 
    RowBox[{
    "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", "S2init",
      ",", 
     RowBox[{"2", " ", "\[Pi]"}], ",", "0", ",", "\[Epsilon]"}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"Rinit", ",", "Pinit", ",", "S1init", ",", "S2init"}], "}"}], "-", 
  RowBox[{"Jzflow", "[", 
   RowBox[{
   "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", "S2init", 
    ",", 
    RowBox[{"2", " ", "\[Pi]"}], ",", "0", ",", "\[Epsilon]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"Rinit", ",", "Pinit", ",", "S1init", ",", "S2init"}], "}"}], "-", 
  RowBox[{"Lflow", "[", 
   RowBox[{
   "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", "S2init", 
    ",", 
    RowBox[{"2", " ", "\[Pi]"}], ",", "0", ",", "\[Epsilon]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8632562623032436`*^9, 3.863256324295909*^9}, {
  3.863262315895427*^9, 3.863262344413768*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"4429d103-3e49-4f02-864e-d66c998f028e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3.774758283725532`*^-15", ",", 
     RowBox[{"-", "5.773159728050814`*^-15"}], ",", 
     "2.886579864025407`*^-15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.551115123125783`*^-16"}], ",", 
     RowBox[{"-", "1.27675647831893`*^-15"}], ",", 
     RowBox[{"-", "7.216449660063518`*^-16"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9.775327371680748`*^-17", ",", 
     RowBox[{"-", "6.938893903907228`*^-17"}], ",", 
     "8.326672684688674`*^-17"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6.938893903907228`*^-18", ",", 
     RowBox[{"-", "8.326672684688674`*^-17"}], ",", 
     RowBox[{"-", "3.747039866432357`*^-17"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8632623305680075`*^9, 3.8632623460127296`*^9}},
 CellLabel->"Out[21]=",ExpressionUUID->"32ed7999-c810-4c1a-8202-3d2a0141f34d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8632623305680075`*^9, 3.8632623460426445`*^9}},
 CellLabel->"Out[22]=",ExpressionUUID->"464a67bb-3c7e-4fc0-b0bb-6d86769c1278"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8632623305680075`*^9, 3.8632623461765537`*^9}},
 CellLabel->"Out[23]=",ExpressionUUID->"f5a6ad0a-3a88-44c7-8caa-22478fa6e554"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Rinit", ",", "Pinit", ",", "S1init", ",", "S2init"}], "}"}], "-", 
   RowBox[{"NmJflow", "[", 
    RowBox[{
    "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", "S2init",
      ",", 
     RowBox[{"2", " ", "\[Pi]"}], ",", "0", ",", "\[Epsilon]"}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"Rinit", ",", "Pinit", ",", "S1init", ",", "S2init"}], "}"}], "-", 
  RowBox[{"NmJzflow", "[", 
   RowBox[{
   "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", "S2init", 
    ",", 
    RowBox[{"2", " ", "\[Pi]"}], ",", "0", ",", "\[Epsilon]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"Rinit", ",", "Pinit", ",", "S1init", ",", "S2init"}], "}"}], "-", 
  RowBox[{"NmLflow", "[", 
   RowBox[{
   "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", "S2init", 
    ",", 
    RowBox[{"2", " ", "\[Pi]"}], ",", "0", ",", "\[Epsilon]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.863263968325928*^9, 3.8632639822134404`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"db57b4cd-87e2-4856-9b26-1f45ce87159c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4.8126483349619775`*^-6", ",", 
     RowBox[{"-", "5.92184956582642`*^-6"}], ",", "3.127491466470289`*^-6"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.965467871904551`*^-7"}], ",", 
     RowBox[{"-", "1.5585151308949996`*^-6"}], ",", 
     RowBox[{"-", "8.257019147861477`*^-7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.21293812453113`*^-7", ",", 
     RowBox[{"-", "6.471861901946596`*^-8"}], ",", "9.497379820089247`*^-8"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.770306212039996`*^-8"}], ",", 
     RowBox[{"-", "1.0288007250280895`*^-7"}], ",", 
     RowBox[{"-", "3.532366804718265`*^-8"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8632639859540777`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"20ed033d-0a70-4ffe-9e6e-40717ddbc953"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.2886803563437752`*^-11", ",", "1.3016379196706396`*^-7", ",", "0.`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.254094799176599`*^-8", ",", 
     RowBox[{"-", "5.721700890859438`*^-12"}], ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.782027718176756`*^-9"}], ",", "1.7826545378740732`*^-9", 
     ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.3172627983125693`*^-9", ",", "1.2472313598577145`*^-9", ",", "0.`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8632639859823313`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"04aa1e42-1888-45c0-a25a-5864a2ae159e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"5.047887046805144`*^-6", ",", 
     RowBox[{"-", "6.0688083132198756`*^-6"}], ",", 
     "3.195104490538725`*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6.422769804892425`*^-7"}], ",", 
     RowBox[{"-", "1.6222350384675899`*^-6"}], ",", 
     RowBox[{"-", "8.056033242165306`*^-7"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8632639861218853`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"a8d010b7-a62c-4c97-a9e9-99c436086b5c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["check action J4 close loop", "Title",
 CellChangeTimes->{{3.8632577839272943`*^9, 
  3.8632578012997704`*^9}},ExpressionUUID->"562a9e48-8ac0-431a-9bfa-\
6c7363f89ceb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Jout", "=", 
   RowBox[{"Jflow", "[", 
    RowBox[{
    "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", "S2init",
      ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], " ", ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jzout", "=", 
   RowBox[{"Jzflow", "[", 
    RowBox[{"m1", ",", "m2", ",", 
     RowBox[{"Jout", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Jout", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Jout", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"Jout", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lout", "=", 
   RowBox[{"Lflow", "[", 
    RowBox[{"m1", ",", "m2", ",", 
     RowBox[{"Jzout", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Jzout", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Jzout", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"Jzout", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hout", "=", 
   RowBox[{"Hflow", "[", 
    RowBox[{"m1", ",", "m2", ",", 
     RowBox[{"Lout", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Lout", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Lout", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"Lout", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Seffout", "=", 
   RowBox[{"SeffLflow", "[", 
    RowBox[{"m1", ",", "m2", ",", 
     RowBox[{"Hout", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Hout", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Hout", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"Hout", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "[", 
       RowBox[{"[", "5", "]"}], "]"}]}], ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"Rinit", ",", "Pinit", ",", "S1init", ",", "S2init"}], "}"}], "-", 
  "Seffout"}]}], "Input",
 CellChangeTimes->{{3.863256632959914*^9, 3.8632566560344725`*^9}, {
   3.863256693546191*^9, 3.8632567149405932`*^9}, 3.8632567462897387`*^9, {
   3.863256792756209*^9, 3.8632568444330215`*^9}, {3.863257220279387*^9, 
   3.8632572660838966`*^9}, {3.863257356977426*^9, 3.8632573630713253`*^9}, {
   3.8632574227809362`*^9, 3.8632574566665263`*^9}, {3.8632626506102962`*^9, 
   3.8632630054152203`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"3e064d26-c5f3-41c5-b3c5-639d7e5c0693"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.000968871677886618`", ",", 
     RowBox[{"-", "0.0011008948966853005`"}], ",", 
     "0.00041860511053370963`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.00007991893700953767`"}], ",", 
     RowBox[{"-", "0.00014509703485787728`"}], ",", 
     RowBox[{"-", "0.00009661810167710394`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.000015320762232318152`"}], ",", "7.85261720995245`*^-6", 
     ",", 
     RowBox[{"-", "7.849349116656468`*^-6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00007619241090187079`", ",", "0.0000724638802177685`", ",", 
     "0.00007196537265530267`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8632630079394636`*^9, 3.8632640504751577`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"d7e18f42-515d-43b4-af1c-a179b7ddc8a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Jout", "=", 
   RowBox[{"NmJflow", "[", 
    RowBox[{
    "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", "S2init",
      ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], " ", ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jzout", "=", 
   RowBox[{"NmJzflow", "[", 
    RowBox[{"m1", ",", "m2", ",", 
     RowBox[{"Jout", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Jout", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Jout", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"Jout", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lout", "=", 
   RowBox[{"NmLflow", "[", 
    RowBox[{"m1", ",", "m2", ",", 
     RowBox[{"Jzout", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Jzout", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Jzout", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"Jzout", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hout", "=", 
   RowBox[{"NmHflow", "[", 
    RowBox[{"m1", ",", "m2", ",", 
     RowBox[{"Lout", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Lout", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Lout", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"Lout", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Seffout", "=", 
   RowBox[{"NmSeffLflow", "[", 
    RowBox[{"m1", ",", "m2", ",", 
     RowBox[{"Hout", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Hout", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Hout", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"Hout", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "[", 
       RowBox[{"[", "5", "]"}], "]"}]}], ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"Rinit", ",", "Pinit", ",", "S1init", ",", "S2init"}], "}"}], "-", 
  "Seffout"}]}], "Input",
 CellChangeTimes->{{3.8632640136326036`*^9, 3.8632640331596437`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"d96fe9cf-8e10-4288-ab28-ebad40400792"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.0015136802016737505`"}], ",", "0.0034136462409093404`", 
     ",", 
     RowBox[{"-", "0.0007223773965856495`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0003161016786678017`", ",", "0.0007889941425672786`", ",", 
     "0.00040486826650720786`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.000013294888925427155`"}], ",", "9.499058140023664`*^-6",
      ",", 
     RowBox[{"-", "9.49579854953031`*^-6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "7.567183195465732`*^-6", ",", "0.000025199525997686434`", ",", 
     "0.000010506119264397848`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.863264039765743*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"4ecd91b3-e739-4f26-bcb8-abff5dcafe49"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check action J5 close loop", "Title",
 CellChangeTimes->{{3.8632578895640078`*^9, 
  3.8632579039406457`*^9}},ExpressionUUID->"055a6693-db26-4081-a100-\
2a83bc4260ab"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Jout", "=", 
   RowBox[{"Jflow", "[", 
    RowBox[{
    "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", "S2init",
      ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], " ", ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jzout", "=", 
   RowBox[{"Jzflow", "[", 
    RowBox[{"m1", ",", "m2", ",", 
     RowBox[{"Jout", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Jout", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Jout", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"Jout", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lout", "=", 
   RowBox[{"Lflow", "[", 
    RowBox[{"m1", ",", "m2", ",", 
     RowBox[{"Jzout", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Jzout", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Jzout", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"Jzout", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hout", "=", 
   RowBox[{"Hflow", "[", 
    RowBox[{"m1", ",", "m2", ",", 
     RowBox[{"Lout", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Lout", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Lout", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"Lout", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Seffout", "=", 
   RowBox[{"SeffLflow", "[", 
    RowBox[{"m1", ",", "m2", ",", 
     RowBox[{"Hout", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Hout", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Hout", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"Hout", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "[", 
       RowBox[{"[", "5", "]"}], "]"}]}], ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"Rinit", ",", "Pinit", ",", "S1init", ",", "S2init"}], "}"}], "-", 
  "Seffout"}]}], "Input",
 CellChangeTimes->{{3.8632630593608084`*^9, 3.8632630857928534`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"bc18b5c8-be3a-4889-86b5-7081e02028e6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.027224665270172865`", ",", 
     RowBox[{"-", "0.01892917606974187`"}], ",", 
     RowBox[{"-", "0.008004596781584272`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.004711582128522185`"}], ",", 
     RowBox[{"-", "0.004998048992967519`"}], ",", 
     RowBox[{"-", "0.0002830410545532902`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.007651221162289001`"}], ",", "0.006332251766767244`", 
     ",", 
     RowBox[{"-", "0.005186270155148581`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.008498579399907308`", ",", "0.015647437208463857`", ",", 
     "0.009681691905738088`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.863263135499593*^9, 3.863264117576848*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"2fdd8111-e2a9-4798-810c-99aba4767b98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Jout", "=", 
   RowBox[{"NmJflow", "[", 
    RowBox[{
    "m1", ",", "m2", ",", "Rinit", ",", "Pinit", ",", "S1init", ",", "S2init",
      ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], " ", ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jzout", "=", 
   RowBox[{"NmJzflow", "[", 
    RowBox[{"m1", ",", "m2", ",", 
     RowBox[{"Jout", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Jout", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Jout", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"Jout", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lout", "=", 
   RowBox[{"NmLflow", "[", 
    RowBox[{"m1", ",", "m2", ",", 
     RowBox[{"Jzout", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Jzout", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Jzout", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"Jzout", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hout", "=", 
   RowBox[{"NmHflow", "[", 
    RowBox[{"m1", ",", "m2", ",", 
     RowBox[{"Lout", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Lout", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Lout", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"Lout", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Seffout", "=", 
   RowBox[{"NmSeffLflow", "[", 
    RowBox[{"m1", ",", "m2", ",", 
     RowBox[{"Hout", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"Hout", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Hout", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"Hout", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]", " ", "*", 
      RowBox[{
       RowBox[{"jcm", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "[", 
       RowBox[{"[", "5", "]"}], "]"}]}], ",", "0", ",", "\[Epsilon]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"Rinit", ",", "Pinit", ",", "S1init", ",", "S2init"}], "}"}], "-", 
  "Seffout"}]}], "Input",
 CellChangeTimes->{{3.8632640855112467`*^9, 3.863264105118722*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"a3113e8c-da00-4f81-920e-51a8ab5871e0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.027150119796104377`", ",", 
     RowBox[{"-", "0.01893665276773504`"}], ",", 
     RowBox[{"-", "0.007920750154877698`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.004799664823186278`"}], ",", 
     RowBox[{"-", "0.005076457206854401`"}], ",", 
     RowBox[{"-", "0.0003408507997535448`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.0076486171976048005`"}], ",", "0.0063328859722649525`", 
     ",", 
     RowBox[{"-", "0.005187071792933151`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.008418002064903216`", ",", "0.015642840910091785`", ",", 
     "0.00961664602715506`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8632641118760414`*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"df96e196-9c1e-4c17-9954-4736a623c9bd"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{949, 461},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"34fb6f4d-c1eb-4483-9577-412638334f19"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 196, 3, 28, "Input",ExpressionUUID->"8d37321c-5352-44b5-807b-da66489eb0e9"],
Cell[757, 25, 192, 3, 28, "Input",ExpressionUUID->"9c9a7de7-211b-440d-976f-f2bae9225fac"],
Cell[952, 30, 179, 3, 28, "Input",ExpressionUUID->"7e913ad4-b4bf-416a-8834-d778b43a185a"],
Cell[1134, 35, 3399, 72, 207, "Input",ExpressionUUID->"a80f7c21-dda8-44c7-bff5-b3529c14f117"],
Cell[CellGroupData[{
Cell[4558, 111, 3417, 71, 223, "Input",ExpressionUUID->"b03250b8-9063-4601-b1c7-36cb36b1055a"],
Cell[7978, 184, 897, 23, 57, "Output",ExpressionUUID->"44ec93a4-21b8-44a1-887e-ff01ba95ae18"],
Cell[8878, 209, 952, 24, 57, "Output",ExpressionUUID->"bdfc6d0b-6157-438a-bc00-b5030606067b"],
Cell[9833, 235, 723, 18, 57, "Output",ExpressionUUID->"50d3f4bf-da70-4876-9c51-28945484c243"],
Cell[10559, 255, 758, 20, 57, "Output",ExpressionUUID->"034ab6c6-fa42-45af-aa3f-09dfc426d78c"],
Cell[11320, 277, 946, 22, 57, "Output",ExpressionUUID->"22ff46fc-2501-4b80-a179-3472a4792be3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12303, 304, 1067, 24, 107, "Input",ExpressionUUID->"ae6e3446-d881-43eb-b0ba-140d413a38d4"],
Cell[13373, 330, 1266, 18, 32, "Output",ExpressionUUID->"728986aa-80bc-4231-a57d-0396b7c9d678"],
Cell[14642, 350, 1395, 21, 32, "Output",ExpressionUUID->"3d1d4ed6-a923-4305-802b-3477c635e728"],
Cell[16040, 373, 1937, 37, 52, "Output",ExpressionUUID->"fbc822bb-8bbb-4a08-856c-f429f5d11b22"],
Cell[17980, 412, 1360, 21, 35, "Output",ExpressionUUID->"34efdea6-8251-4a31-a48d-327c9f5c7c63"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19377, 438, 228, 4, 98, "Title",ExpressionUUID->"eb7e98c3-1c49-49e6-b68f-b986127b514b"],
Cell[CellGroupData[{
Cell[19630, 446, 1218, 31, 68, "Input",ExpressionUUID->"4429d103-3e49-4f02-864e-d66c998f028e"],
Cell[20851, 479, 900, 21, 57, "Output",ExpressionUUID->"32ed7999-c810-4c1a-8202-3d2a0141f34d"],
Cell[21754, 502, 502, 12, 32, "Output",ExpressionUUID->"464a67bb-3c7e-4fc0-b0bb-6d86769c1278"],
Cell[22259, 516, 502, 12, 32, "Output",ExpressionUUID->"f5a6ad0a-3a88-44c7-8caa-22478fa6e554"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22798, 533, 1175, 30, 68, "Input",ExpressionUUID->"db57b4cd-87e2-4856-9b26-1f45ce87159c"],
Cell[23976, 565, 883, 22, 57, "Output",ExpressionUUID->"20ed033d-0a70-4ffe-9e6e-40717ddbc953"],
Cell[24862, 589, 703, 19, 57, "Output",ExpressionUUID->"04aa1e42-1888-45c0-a25a-5864a2ae159e"],
Cell[25568, 610, 682, 17, 35, "Output",ExpressionUUID->"a8d010b7-a62c-4c97-a9e9-99c436086b5c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26299, 633, 173, 3, 98, "Title",ExpressionUUID->"562a9e48-8ac0-431a-9bfa-6c7363f89ceb"],
Cell[CellGroupData[{
Cell[26497, 640, 3571, 95, 126, "Input",ExpressionUUID->"3e064d26-c5f3-41c5-b3c5-639d7e5c0693"],
Cell[30071, 737, 883, 22, 57, "Output",ExpressionUUID->"d7e18f42-515d-43b4-af1c-a179b7ddc8a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30991, 764, 3247, 90, 126, "Input",ExpressionUUID->"d96fe9cf-8e10-4288-ab28-ebad40400792"],
Cell[34241, 856, 826, 22, 57, "Output",ExpressionUUID->"4ecd91b3-e739-4f26-bcb8-abff5dcafe49"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35116, 884, 173, 3, 98, "Title",ExpressionUUID->"055a6693-db26-4081-a100-2a83bc4260ab"],
Cell[CellGroupData[{
Cell[35314, 891, 3237, 90, 126, "Input",ExpressionUUID->"bc18b5c8-be3a-4889-86b5-7081e02028e6"],
Cell[38554, 983, 876, 22, 99, "Output",ExpressionUUID->"2fdd8111-e2a9-4798-810c-99aba4767b98"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39467, 1010, 3245, 90, 126, "Input",ExpressionUUID->"a3113e8c-da00-4f81-920e-51a8ab5871e0"],
Cell[42715, 1102, 857, 22, 52, "Output",ExpressionUUID->"df96e196-9c1e-4c17-9954-4736a623c9bd"]
}, Open  ]]
}, Open  ]]
}
]
*)

