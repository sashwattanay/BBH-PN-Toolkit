(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     48140,       1423]
NotebookOptionsPosition[     45789,       1375]
NotebookOutlinePosition[     46189,       1391]
CellTagsIndexPosition[     46146,       1388]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.861329857079235*^9, 3.861329859224377*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"1224f43d-f341-450d-944d-7104ab01559d"],

Cell[CellGroupData[{

Cell["solutions for \[Phi]L and \[Phi]", "Title",
 CellChangeTimes->{
  3.86132983011809*^9},ExpressionUUID->"666f8abb-1bf2-48ee-b7f0-4e4d61ef635b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "=", 
    RowBox[{"JacobiAmplitude", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        SqrtBox[
         RowBox[{"A", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]", "-", "\[Lambda]0"}], ")"}]}], "+", 
       RowBox[{"\[Alpha]", 
        FractionBox[
         SqrtBox[
          RowBox[{"A", 
           RowBox[{"(", 
            RowBox[{"f3", "-", "f1"}], ")"}]}]], "2"]}]}], ",", "k"}], 
     "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"\[Alpha]", "=", 
    RowBox[{
     FractionBox["2", 
      SqrtBox[
       RowBox[{"A", 
        RowBox[{"(", 
         RowBox[{"f3", "-", "f1"}], ")"}]}]]], 
     RowBox[{"EllipticF", "[", 
      RowBox[{
       RowBox[{"ArcSin", "[", 
        SqrtBox[
         FractionBox[
          RowBox[{"f0", "-", "f1"}], 
          RowBox[{"f2", "-", "f1"}]]], "]"}], ",", "k"}], "]"}], " ", "is", 
     " ", "used", " ", "to", " ", "substitute", " ", 
     RowBox[{"EllipticF", "[", 
      RowBox[{
       RowBox[{"ArcSin", "[", 
        SqrtBox[
         FractionBox[
          RowBox[{"f0", "-", "f1"}], 
          RowBox[{"f2", "-", "f1"}]]], "]"}], ",", "k"}], "]"}], " ", "in", 
     " ", "\[Beta]", " ", "expression"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiLexp", "=", 
   RowBox[{"\[Phi]Lc", " ", "+", 
    RowBox[{
     FractionBox["2", 
      SqrtBox[
       RowBox[{"A", " ", 
        RowBox[{"(", 
         RowBox[{"f3", "-", "f1"}], ")"}]}]]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", 
         RowBox[{"D1", "-", 
          RowBox[{"f1", " ", 
           RowBox[{"(", " ", 
            RowBox[{"Q1", " ", "-", "Q2"}], ")"}]}]}]], "B1", "  ", 
        RowBox[{"EllipticPi", "[", 
         RowBox[{"\[Alpha]1sq", ",", "\[Gamma]", ",", "k"}], "]"}]}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"D2", "-", 
          RowBox[{"f1", " ", 
           RowBox[{"(", " ", 
            RowBox[{"Q1", " ", "-", "Q2"}], ")"}]}]}]], "B2", "  ", 
        RowBox[{"EllipticPi", "[", 
         RowBox[{"\[Alpha]2sq", ",", "\[Gamma]", ",", "k"}], "]"}]}]}], 
      ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phiexp", "=", 
    RowBox[{"\[Phi]c", "+", 
     RowBox[{
      FractionBox["2", 
       SqrtBox[
        RowBox[{"A", " ", 
         RowBox[{"(", 
          RowBox[{"f3", "-", "f1"}], ")"}]}]]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"D1", "-", 
           RowBox[{"f1", " ", 
            RowBox[{"(", " ", 
             RowBox[{"Q1", " ", "-", "Q2"}], ")"}]}]}]], "B1", "  ", 
         RowBox[{"EllipticPi", "[", 
          RowBox[{"\[Alpha]1sq", ",", "\[Gamma]", ",", "k"}], "]"}]}], "-", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"D2", "-", 
           RowBox[{"f1", " ", 
            RowBox[{"(", " ", 
             RowBox[{"Q1", " ", "-", "Q2"}], ")"}]}]}]], "B2", "  ", 
         RowBox[{"EllipticPi", "[", 
          RowBox[{"\[Alpha]2sq", ",", "\[Gamma]", ",", "k"}], "]"}]}]}], 
       ")"}]}], " ", "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"SeffL", " ", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[CapitalDelta]1", "-", "\[CapitalDelta]2"}], ")"}], " ", 
         "Q1", " ", "Q2"}], " ", "+", 
        RowBox[{
         SuperscriptBox["Ln", "2"], 
         RowBox[{"(", 
          RowBox[{"Q1", "+", "Q2"}], ")"}]}]}], ")"}], 
      FractionBox[
       RowBox[{"(", 
        RowBox[{"\[Lambda]", "-", "\[Lambda]0"}], ")"}], "Ln"]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "note", " ", "the", " ", "minus", " ", "in", " ", "between", " ", "in", 
    " ", "the", " ", "2", "nd", " ", "term"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Determining", " ", "\[Phi]Lc", " ", "and", " ", "\[Phi]c"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq1", "=", 
   RowBox[{
    RowBox[{"phiLexp", "/.", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]", "\[Rule]", "\[Lambda]0"}], "}"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiLcsol", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"eq1", "\[Equal]", "\[Phi]L0"}], ",", "\[Phi]Lc"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq2", "=", 
   RowBox[{
    RowBox[{"phiexp", "/.", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]", "\[Rule]", "\[Lambda]0"}], "}"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phicsol", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"eq2", "\[Equal]", "\[Phi]R0"}], ",", "\[Phi]c"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiLexp", "/.", "phiLcsol"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiexp", "/.", "phicsol"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.8613300849714384`*^9, 3.8613302192753196`*^9}, {
   3.8613302561784925`*^9, 3.8613302652027426`*^9}, 3.861336828520492*^9, {
   3.86189015707594*^9, 3.8618901607472043`*^9}, {3.8618903650121193`*^9, 
   3.861890427041092*^9}, {3.8618906920518093`*^9, 3.861890807330329*^9}, {
   3.8618913787472005`*^9, 3.861891392409258*^9}, 3.8618917808808103`*^9, {
   3.8623652267523737`*^9, 3.862365232399639*^9}, {3.8623652957328014`*^9, 
   3.8623653055274906`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"dfb3cfcf-801d-462b-b592-fe81aeb90dcb"],

Cell[BoxData[
 RowBox[{"\[Phi]L0", "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"B1", " ", 
        RowBox[{"EllipticPi", "[", 
         RowBox[{"\[Alpha]1sq", ",", 
          RowBox[{"JacobiAmplitude", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{"A", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
             "\[Alpha]"}], ",", "k"}], "]"}], ",", "k"}], "]"}]}], 
       RowBox[{"D1", "+", 
        RowBox[{"f1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Q1"}], "+", "Q2"}], ")"}]}]}]], "+", 
      FractionBox[
       RowBox[{"B2", " ", 
        RowBox[{"EllipticPi", "[", 
         RowBox[{"\[Alpha]2sq", ",", 
          RowBox[{"JacobiAmplitude", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{"A", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
             "\[Alpha]"}], ",", "k"}], "]"}], ",", "k"}], "]"}]}], 
       RowBox[{"D2", "+", 
        RowBox[{"f1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Q1"}], "+", "Q2"}], ")"}]}]}]]}], ")"}]}], 
   SqrtBox[
    RowBox[{"A", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"B1", " ", 
        RowBox[{"EllipticPi", "[", 
         RowBox[{"\[Alpha]1sq", ",", 
          RowBox[{"JacobiAmplitude", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{"A", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
             RowBox[{"(", 
              RowBox[{"\[Alpha]", "+", "\[Lambda]", "-", "\[Lambda]0"}], 
              ")"}]}], ",", "k"}], "]"}], ",", "k"}], "]"}]}], 
       RowBox[{"D1", "+", 
        RowBox[{"f1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Q1"}], "+", "Q2"}], ")"}]}]}]], "+", 
      FractionBox[
       RowBox[{"B2", " ", 
        RowBox[{"EllipticPi", "[", 
         RowBox[{"\[Alpha]2sq", ",", 
          RowBox[{"JacobiAmplitude", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{"A", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
             RowBox[{"(", 
              RowBox[{"\[Alpha]", "+", "\[Lambda]", "-", "\[Lambda]0"}], 
              ")"}]}], ",", "k"}], "]"}], ",", "k"}], "]"}]}], 
       RowBox[{"D2", "+", 
        RowBox[{"f1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Q1"}], "+", "Q2"}], ")"}]}]}]]}], ")"}]}], 
   SqrtBox[
    RowBox[{"A", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]]]}]], "Output",
 CellChangeTimes->{
  3.8613298651917315`*^9, {3.8613302753154755`*^9, 3.86133028469425*^9}, 
   3.861330482919839*^9, 3.8613368450682635`*^9, 3.8618904390671005`*^9, 
   3.8618908310545263`*^9, 3.861891064860964*^9, 3.8618914158102975`*^9, 
   3.861891793370243*^9, 3.8623653255681496`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"0377119f-ef47-4d11-8b28-c2fb2422b4a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["Ln", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"Q1", "+", "Q2"}], ")"}]}], "+", "SeffL", "+", 
       RowBox[{"Q1", " ", "Q2", " ", 
        RowBox[{"(", 
         RowBox[{"\[CapitalDelta]1", "-", "\[CapitalDelta]2"}], ")"}]}]}], 
      ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"\[Lambda]", "-", "\[Lambda]0"}], ")"}]}], "Ln"]}], "+", 
  "\[Phi]R0", "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"B1", " ", 
        RowBox[{"EllipticPi", "[", 
         RowBox[{"\[Alpha]1sq", ",", 
          RowBox[{"JacobiAmplitude", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{"A", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
             "\[Alpha]"}], ",", "k"}], "]"}], ",", "k"}], "]"}]}], 
       RowBox[{"D1", "+", 
        RowBox[{"f1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Q1"}], "+", "Q2"}], ")"}]}]}]], "-", 
      FractionBox[
       RowBox[{"B2", " ", 
        RowBox[{"EllipticPi", "[", 
         RowBox[{"\[Alpha]2sq", ",", 
          RowBox[{"JacobiAmplitude", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{"A", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
             "\[Alpha]"}], ",", "k"}], "]"}], ",", "k"}], "]"}]}], 
       RowBox[{"D2", "+", 
        RowBox[{"f1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Q1"}], "+", "Q2"}], ")"}]}]}]]}], ")"}]}], 
   SqrtBox[
    RowBox[{"A", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"B1", " ", 
        RowBox[{"EllipticPi", "[", 
         RowBox[{"\[Alpha]1sq", ",", 
          RowBox[{"JacobiAmplitude", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{"A", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
             RowBox[{"(", 
              RowBox[{"\[Alpha]", "+", "\[Lambda]", "-", "\[Lambda]0"}], 
              ")"}]}], ",", "k"}], "]"}], ",", "k"}], "]"}]}], 
       RowBox[{"D1", "+", 
        RowBox[{"f1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Q1"}], "+", "Q2"}], ")"}]}]}]], "-", 
      FractionBox[
       RowBox[{"B2", " ", 
        RowBox[{"EllipticPi", "[", 
         RowBox[{"\[Alpha]2sq", ",", 
          RowBox[{"JacobiAmplitude", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{"A", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
             RowBox[{"(", 
              RowBox[{"\[Alpha]", "+", "\[Lambda]", "-", "\[Lambda]0"}], 
              ")"}]}], ",", "k"}], "]"}], ",", "k"}], "]"}]}], 
       RowBox[{"D2", "+", 
        RowBox[{"f1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Q1"}], "+", "Q2"}], ")"}]}]}]]}], ")"}]}], 
   SqrtBox[
    RowBox[{"A", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]]]}]], "Output",
 CellChangeTimes->{
  3.8613298651917315`*^9, {3.8613302753154755`*^9, 3.86133028469425*^9}, 
   3.861330482919839*^9, 3.8613368450682635`*^9, 3.8618904390671005`*^9, 
   3.8618908310545263`*^9, 3.861891064860964*^9, 3.8618914158102975`*^9, 
   3.861891793370243*^9, 3.862365325971436*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"c3665678-b589-4273-a542-f3709bf9f711"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["constructing euler matrix", "Title",
 CellChangeTimes->{{3.861331194217414*^9, 
  3.861331200120268*^9}},ExpressionUUID->"88ad98b6-6c39-42f7-a5c2-\
6fdd1c9f8629"],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.8613336090325623`*^9, 3.8613336111714325`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"424afda7-fd38-460b-9d2b-b5db26624aff"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Cosgm", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"(", " ", 
      RowBox[{"Q1", " ", "-", "Q2"}], ")"}], 
     RowBox[{"S1n", " ", "S2n"}]], "f"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coskp1", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Cosgm", "-", " ", "\[CapitalSigma]1"}], ")"}], "S2n", " ", 
     "Q2"}], 
    RowBox[{"Ln", " ", 
     RowBox[{"(", " ", 
      RowBox[{"Q1", " ", "-", "Q2"}], ")"}]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Coskp2", "=", 
    RowBox[{"\[CapitalSigma]2", " ", "-", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"Q1", " ", "S1n"}], 
       RowBox[{"Q2", " ", "S2n"}]], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Cosgm", "-", " ", "\[CapitalSigma]1"}], ")"}], "S2n", "  ",
          "Q2"}], 
        RowBox[{"Ln", " ", 
         RowBox[{"(", " ", 
          RowBox[{"Q1", " ", "-", "Q2"}], ")"}]}]], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"J", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]JL", "[", "\[Lambda]", "]"}], "]"}]}], "=", 
    RowBox[{"L", "+", " ", 
     RowBox[{"S1", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Kappa]1", "[", "\[Lambda]", "]"}], "]"}]}], "+", " ", 
     RowBox[{"S2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Kappa]2", "[", "\[Lambda]", "]"}], "]"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cos\[Theta]JL", "=", 
    FractionBox[
     RowBox[{"Ln", "+", " ", 
      RowBox[{"S1n", " ", "Coskp1"}], "+", " ", 
      RowBox[{"S2n", " ", "Coskp2"}]}], "Jn"]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sin\[Theta]JL", "=", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", "Cos\[Theta]JL", ")"}], "2"]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Emat", "=", 
  RowBox[{
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Pi]", "/", "2"}], ")"}], "+", "\[Phi]L"}], "]"}], 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Pi]", "/", "2"}], ")"}], "+", "\[Phi]L"}], "]"}], "0"},
      {
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Pi]", "/", "2"}], ")"}], "+", "\[Phi]L"}], "]"}]}], 
        " ", "Cos\[Theta]JL"}], 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Pi]", "/", "2"}], ")"}], "+", "\[Phi]L"}], "]"}], " ", 
        "Cos\[Theta]JL"}], "Sin\[Theta]JL"},
      {
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Pi]", "/", "2"}], ")"}], "+", "\[Phi]L"}], "]"}], " ", 
        "Sin\[Theta]JL"}], 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Pi]", "/", "2"}], ")"}], "+", "\[Phi]L"}], "]"}]}], 
        " ", "Sin\[Theta]JL"}], "Cos\[Theta]JL"}
     }], ")"}], "//", "Simplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8613312617715187`*^9, 3.861331263671134*^9}, {
  3.861331945978634*^9, 3.8613321483772736`*^9}, {3.861332195616015*^9, 
  3.861332207164953*^9}, {3.8613324077821274`*^9, 3.8613325506664395`*^9}, {
  3.861332629370298*^9, 3.861332850843484*^9}, {3.8613333690465264`*^9, 
  3.8613333695690136`*^9}, {3.8613335718996105`*^9, 3.861333593964157*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"bf9bce0d-9d7e-409d-8531-a06ad0e7afe1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Phi]L", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Phi]L", "]"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Ln", "2"], "+", 
          RowBox[{"f", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "Q1"}], "+", "Q2"}], ")"}]}], "+", 
          RowBox[{"S1n", " ", "S2n", " ", "\[CapitalSigma]1"}], "+", 
          RowBox[{"Ln", " ", "S2n", " ", "\[CapitalSigma]2"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]L", "]"}]}], 
       RowBox[{"Jn", " ", "Ln"}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Ln", "2"], "+", 
          RowBox[{"f", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "Q1"}], "+", "Q2"}], ")"}]}], "+", 
          RowBox[{"S1n", " ", "S2n", " ", "\[CapitalSigma]1"}], "+", 
          RowBox[{"Ln", " ", "S2n", " ", "\[CapitalSigma]2"}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]L", "]"}]}], 
       RowBox[{"Jn", " ", "Ln"}]]}], ",", 
     SqrtBox[
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["Jn", "2"], " ", 
         SuperscriptBox["Ln", "2"]}], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Ln", "2"], "+", 
           RowBox[{"f", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "Q1"}], "+", "Q2"}], ")"}]}], "+", 
           RowBox[{"S1n", " ", "S2n", " ", "\[CapitalSigma]1"}], "+", 
           RowBox[{"Ln", " ", "S2n", " ", "\[CapitalSigma]2"}]}], ")"}], 
         "2"]}], 
       RowBox[{
        SuperscriptBox["Jn", "2"], " ", 
        SuperscriptBox["Ln", "2"]}]]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["Jn", "2"], " ", 
          SuperscriptBox["Ln", "2"]}], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Ln", "2"], "+", 
            RowBox[{"f", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "Q1"}], "+", "Q2"}], ")"}]}], "+", 
            RowBox[{"S1n", " ", "S2n", " ", "\[CapitalSigma]1"}], "+", 
            RowBox[{"Ln", " ", "S2n", " ", "\[CapitalSigma]2"}]}], ")"}], 
          "2"]}], 
        RowBox[{
         SuperscriptBox["Jn", "2"], " ", 
         SuperscriptBox["Ln", "2"]}]]], " ", 
      RowBox[{"Cos", "[", "\[Phi]L", "]"}]}], ",", 
     RowBox[{
      SqrtBox[
       FractionBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["Jn", "2"], " ", 
          SuperscriptBox["Ln", "2"]}], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Ln", "2"], "+", 
            RowBox[{"f", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "Q1"}], "+", "Q2"}], ")"}]}], "+", 
            RowBox[{"S1n", " ", "S2n", " ", "\[CapitalSigma]1"}], "+", 
            RowBox[{"Ln", " ", "S2n", " ", "\[CapitalSigma]2"}]}], ")"}], 
          "2"]}], 
        RowBox[{
         SuperscriptBox["Jn", "2"], " ", 
         SuperscriptBox["Ln", "2"]}]]], " ", 
      RowBox[{"Sin", "[", "\[Phi]L", "]"}]}], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["Ln", "2"], "-", 
       RowBox[{"f", " ", "Q1"}], "+", 
       RowBox[{"f", " ", "Q2"}], "+", 
       RowBox[{"S1n", " ", "S2n", " ", "\[CapitalSigma]1"}], "+", 
       RowBox[{"Ln", " ", "S2n", " ", "\[CapitalSigma]2"}]}], 
      RowBox[{"Jn", " ", "Ln"}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8613326216284103`*^9, 3.861332633556465*^9}, 
   3.8613326965288286`*^9, {3.8613328419358277`*^9, 3.861332852088117*^9}, {
   3.861333360559367*^9, 3.8613333753472815`*^9}, 3.861333616578436*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"9ec95b93-5a98-4358-a260-eee26ca6c0ca"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Rfinal", "=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Inverse", "[", "Emat", "]"}], ".", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"R", " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}]},
        {
         RowBox[{"R", " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}]},
        {"0"}
       }], ")"}]}], "]"}], "//", "Simplify", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"in", " ", "inertial", " ", "frame"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8613328725515776`*^9, 
  3.8613328763716917`*^9}},ExpressionUUID->"0260daec-be3b-42ad-be55-\
42b8cb44c77e"],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.8613468558559465`*^9, 3.8613468579124002`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"5dd77733-b920-41fa-8169-30e41777423a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["subspin space", "Title",
 CellChangeTimes->{{3.861345752135371*^9, 
  3.86134575514699*^9}},ExpressionUUID->"62d2531a-e898-4343-9ff0-\
bc45b3aa99a6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "=", 
    RowBox[{"JacobiAmplitude", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        SqrtBox[
         RowBox[{"A", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]", "-", "\[Lambda]0"}], ")"}]}], "+", 
       RowBox[{"\[Alpha]", 
        FractionBox[
         SqrtBox[
          RowBox[{"A", 
           RowBox[{"(", 
            RowBox[{"f3", "-", "f1"}], ")"}]}]], "2"]}]}], ",", "k"}], 
     "]"}]}], ";", " ", 
   RowBox[{"(*", 
    RowBox[{"\[Alpha]", "=", 
     RowBox[{
      FractionBox["2", 
       SqrtBox[
        RowBox[{"A", 
         RowBox[{"(", 
          RowBox[{"f3", "-", "f1"}], ")"}]}]]], 
      RowBox[{"EllipticF", "[", 
       RowBox[{
        RowBox[{"ArcSin", "[", 
         SqrtBox[
          FractionBox[
           RowBox[{"f0", "-", "f1"}], 
           RowBox[{"f2", "-", "f1"}]]], "]"}], ",", "k"}], "]"}], " ", "is", 
      " ", "used", " ", "to", " ", "substitute", " ", 
      RowBox[{"EllipticF", "[", 
       RowBox[{
        RowBox[{"ArcSin", "[", 
         SqrtBox[
          FractionBox[
           RowBox[{"f0", "-", "f1"}], 
           RowBox[{"f2", "-", "f1"}]]], "]"}], ",", "k"}], "]"}], " ", "in", 
      " ", "\[Beta]", " ", "expression"}]}], "*)"}], 
   RowBox[{"phiS1exp", "=", 
    RowBox[{"\[Phi]S1c", " ", "+", " ", 
     RowBox[{"Jn", " ", "Q2", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]", "-", "\[Lambda]0"}], ")"}]}], "+", 
     RowBox[{
      FractionBox["2", 
       SqrtBox[
        RowBox[{"A", " ", 
         RowBox[{"(", 
          RowBox[{"f3", "-", "f1"}], ")"}]}]]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"D1s1", "+", 
           RowBox[{"f1", " ", "Q1", " "}]}]], "B1s1", "  ", 
         RowBox[{"EllipticPi", "[", 
          RowBox[{"\[Alpha]1s1sq", ",", "\[Gamma]", ",", "k"}], "]"}]}], "+", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"D2s1", " ", "+", 
           RowBox[{"f1", " ", "Q1"}]}]], "B2s1", "  ", 
         RowBox[{"EllipticPi", "[", 
          RowBox[{"\[Alpha]2s1sq", ",", "\[Gamma]", ",", "k"}], "]"}]}]}], 
       ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phiexp", "=", 
    RowBox[{"\[Phi]c", "-", 
     RowBox[{
      FractionBox["2", 
       SqrtBox[
        RowBox[{"A", " ", 
         RowBox[{"(", 
          RowBox[{"f3", "-", "f1"}], ")"}]}]]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"D1s1", "+", 
           RowBox[{"f1", " ", 
            RowBox[{"(", " ", "Q1", " ", ")"}]}]}]], "B1s1", "  ", 
         RowBox[{"EllipticPi", "[", 
          RowBox[{"\[Alpha]1s1sq", ",", "\[Gamma]", ",", "k"}], "]"}]}], "-", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"D2s1", "+", 
           RowBox[{"f1", " ", 
            RowBox[{"(", " ", "Q1", " ", ")"}]}]}]], "B2s1", "  ", 
         RowBox[{"EllipticPi", "[", 
          RowBox[{"\[Alpha]2s1sq", ",", "\[Gamma]", ",", "k"}], "]"}]}]}], 
       ")"}]}], " ", "+", 
     RowBox[{"S1n", 
      RowBox[{"(", 
       RowBox[{"Q2", "-", "Q1"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"\[Lambda]", "-", "\[Lambda]0"}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Determining", " ", "\[Phi]S1c", " ", "and", " ", "\[Phi]c"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq1", "=", 
   RowBox[{
    RowBox[{"phiS1exp", "/.", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]", "\[Rule]", "\[Lambda]0"}], "}"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiS1csol", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"eq1", "\[Equal]", "\[Phi]S10"}], ",", "\[Phi]S1c"}], "]"}], 
    "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq2", "=", 
   RowBox[{
    RowBox[{"phiexp", "/.", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]", "\[Rule]", "\[Lambda]0"}], "}"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phicsol", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"eq2", "\[Equal]", "\[Phi]R0"}], ",", "\[Phi]c"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiS1exp", "/.", "phiS1csol"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiexp", "/.", "phicsol"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.861345759662595*^9, 3.8613458655764503`*^9}, {
  3.8613459951894627`*^9, 3.8613459962698774`*^9}, {3.8613460496292973`*^9, 
  3.8613460915404177`*^9}, {3.861346133263409*^9, 3.861346138530382*^9}, {
  3.861346198457404*^9, 3.8613462275177975`*^9}, {3.861346466031252*^9, 
  3.8613465020376153`*^9}, {3.8613465602379293`*^9, 3.861346678510809*^9}, {
  3.861346723591589*^9, 3.8613467472479353`*^9}, {3.8613467878560963`*^9, 
  3.861346847366756*^9}, {3.8613469345844536`*^9, 3.8613469783799734`*^9}, {
  3.8613487766624565`*^9, 3.8613487890765276`*^9}, {3.8613499333813095`*^9, 
  3.86134993676789*^9}, {3.8623702867069235`*^9, 3.8623702907641726`*^9}, {
  3.8623725089524765`*^9, 3.8623726075501385`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"f1801e3f-966e-4b66-8d7c-2561136acd6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Jn", " ", "Q2", " ", 
   RowBox[{"(", 
    RowBox[{"\[Lambda]", "-", "\[Lambda]0"}], ")"}]}], "+", "\[Phi]S10", "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"B1s1", " ", 
        RowBox[{"EllipticPi", "[", 
         RowBox[{"\[Alpha]1s1sq", ",", 
          RowBox[{"JacobiAmplitude", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{"A", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
             "\[Alpha]"}], ",", "k"}], "]"}], ",", "k"}], "]"}]}], 
       RowBox[{"D1s1", "+", 
        RowBox[{"f1", " ", "Q1"}]}]], "+", 
      FractionBox[
       RowBox[{"B2s1", " ", 
        RowBox[{"EllipticPi", "[", 
         RowBox[{"\[Alpha]2s1sq", ",", 
          RowBox[{"JacobiAmplitude", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{"A", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
             "\[Alpha]"}], ",", "k"}], "]"}], ",", "k"}], "]"}]}], 
       RowBox[{"D2s1", "+", 
        RowBox[{"f1", " ", "Q1"}]}]]}], ")"}]}], 
   SqrtBox[
    RowBox[{"A", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"B1s1", " ", 
        RowBox[{"(", 
         RowBox[{"D2s1", "+", 
          RowBox[{"f1", " ", "Q1"}]}], ")"}], " ", 
        RowBox[{"EllipticPi", "[", 
         RowBox[{"\[Alpha]1s1sq", ",", 
          RowBox[{"JacobiAmplitude", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{"A", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
             RowBox[{"(", 
              RowBox[{"\[Alpha]", "+", "\[Lambda]", "-", "\[Lambda]0"}], 
              ")"}]}], ",", "k"}], "]"}], ",", "k"}], "]"}]}], "+", 
       RowBox[{"B2s1", " ", 
        RowBox[{"(", 
         RowBox[{"D1s1", "+", 
          RowBox[{"f1", " ", "Q1"}]}], ")"}], " ", 
        RowBox[{"EllipticPi", "[", 
         RowBox[{"\[Alpha]2s1sq", ",", 
          RowBox[{"JacobiAmplitude", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{"A", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
             RowBox[{"(", 
              RowBox[{"\[Alpha]", "+", "\[Lambda]", "-", "\[Lambda]0"}], 
              ")"}]}], ",", "k"}], "]"}], ",", "k"}], "]"}]}]}], ")"}]}], 
    ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     SqrtBox[
      RowBox[{"A", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{"D1s1", "+", 
       RowBox[{"f1", " ", "Q1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"D2s1", "+", 
       RowBox[{"f1", " ", "Q1"}]}], ")"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.861346866054826*^9, 3.861346993644009*^9, 
  3.86134767449531*^9, 3.8613483298804393`*^9, 3.86134884340143*^9, 
  3.861350167056322*^9, 3.8623703057074337`*^9, 3.862372620149918*^9, 
  3.8623727284992905`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"724c2f64-7c89-4b98-b73b-dc0ef5302e95"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "Q1"}], "+", "Q2"}], ")"}], " ", "S1n", " ", 
   RowBox[{"(", 
    RowBox[{"\[Lambda]", "-", "\[Lambda]0"}], ")"}]}], "+", "\[Phi]R0", "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"B1s1", " ", 
        RowBox[{"EllipticPi", "[", 
         RowBox[{"\[Alpha]1s1sq", ",", 
          RowBox[{"JacobiAmplitude", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{"A", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
             "\[Alpha]"}], ",", "k"}], "]"}], ",", "k"}], "]"}]}], 
       RowBox[{"D1s1", "+", 
        RowBox[{"f1", " ", "Q1"}]}]], "-", 
      FractionBox[
       RowBox[{"B2s1", " ", 
        RowBox[{"EllipticPi", "[", 
         RowBox[{"\[Alpha]2s1sq", ",", 
          RowBox[{"JacobiAmplitude", "[", 
           RowBox[{
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{"A", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
             "\[Alpha]"}], ",", "k"}], "]"}], ",", "k"}], "]"}]}], 
       RowBox[{"D2s1", "+", 
        RowBox[{"f1", " ", "Q1"}]}]]}], ")"}]}], 
   SqrtBox[
    RowBox[{"A", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "B1s1", " ", 
      RowBox[{"(", 
       RowBox[{"D2s1", "+", 
        RowBox[{"f1", " ", "Q1"}]}], ")"}], " ", 
      RowBox[{"EllipticPi", "[", 
       RowBox[{"\[Alpha]1s1sq", ",", 
        RowBox[{"JacobiAmplitude", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           SqrtBox[
            RowBox[{"A", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
           RowBox[{"(", 
            RowBox[{"\[Alpha]", "+", "\[Lambda]", "-", "\[Lambda]0"}], 
            ")"}]}], ",", "k"}], "]"}], ",", "k"}], "]"}]}], "+", 
     RowBox[{"2", " ", "B2s1", " ", 
      RowBox[{"(", 
       RowBox[{"D1s1", "+", 
        RowBox[{"f1", " ", "Q1"}]}], ")"}], " ", 
      RowBox[{"EllipticPi", "[", 
       RowBox[{"\[Alpha]2s1sq", ",", 
        RowBox[{"JacobiAmplitude", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           SqrtBox[
            RowBox[{"A", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
           RowBox[{"(", 
            RowBox[{"\[Alpha]", "+", "\[Lambda]", "-", "\[Lambda]0"}], 
            ")"}]}], ",", "k"}], "]"}], ",", "k"}], "]"}]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     SqrtBox[
      RowBox[{"A", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "f1"}], "+", "f3"}], ")"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{"D1s1", "+", 
       RowBox[{"f1", " ", "Q1"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"D2s1", "+", 
       RowBox[{"f1", " ", "Q1"}]}], ")"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.861346866054826*^9, 3.861346993644009*^9, 
  3.86134767449531*^9, 3.8613483298804393`*^9, 3.86134884340143*^9, 
  3.861350167056322*^9, 3.8623703057074337`*^9, 3.862372620149918*^9, 
  3.8623727285642543`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"3acc4829-3626-429d-8f1d-e8402f0459a9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["constructing euler matrix for subspin space", "Title",
 CellChangeTimes->{{3.861347390205248*^9, 
  3.8613474005495234`*^9}},ExpressionUUID->"05a91ee6-d03f-4adf-9000-\
4f15e9b89d31"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Cosgm", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"(", " ", 
      RowBox[{"Q1", " ", "-", "Q2"}], ")"}], 
     RowBox[{"S1n", " ", "S2n"}]], "f"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coskp1", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Cosgm", "-", " ", "\[CapitalSigma]1"}], ")"}], "S2n", " ", 
     "Q2"}], 
    RowBox[{"Ln", " ", 
     RowBox[{"(", " ", 
      RowBox[{"Q1", " ", "-", "Q2"}], ")"}]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Coskp2", "=", 
    RowBox[{"\[CapitalSigma]2", " ", "-", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"Q1", " ", "S1n"}], 
       RowBox[{"Q2", " ", "S2n"}]], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Cosgm", "-", " ", "\[CapitalSigma]1"}], ")"}], "S2n", "  ",
          "Q2"}], 
        RowBox[{"Ln", " ", 
         RowBox[{"(", " ", 
          RowBox[{"Q1", " ", "-", "Q2"}], ")"}]}]], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"J", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]JS1", "[", "\[Lambda]", "]"}], "]"}]}], "=", 
    RowBox[{"S1", "+", " ", 
     RowBox[{"L", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Kappa]1", "[", "\[Lambda]", "]"}], "]"}]}], "+", " ", 
     RowBox[{"S2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Gamma]", "[", "\[Lambda]", "]"}], "]"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cos\[Theta]JS1", "=", 
    FractionBox[
     RowBox[{"S1n", "+", " ", 
      RowBox[{"Ln", " ", "Coskp1"}], "+", " ", 
      RowBox[{"S2n", " ", "Cosgm"}]}], "Jn"]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sin\[Theta]JS1", "=", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", "Cos\[Theta]JS1", ")"}], "2"]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"EmatS1", "=", 
  RowBox[{
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Pi]", "/", "2"}], ")"}], "+", "\[Phi]S1"}], "]"}], 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Pi]", "/", "2"}], ")"}], "+", "\[Phi]S1"}], "]"}], "0"},
      {
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Pi]", "/", "2"}], ")"}], "+", "\[Phi]S1"}], "]"}]}], 
        " ", "Cos\[Theta]JS1"}], 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Pi]", "/", "2"}], ")"}], "+", "\[Phi]S1"}], "]"}], " ", 
        "Cos\[Theta]JS1"}], "Sin\[Theta]JS1"},
      {
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Pi]", "/", "2"}], ")"}], "+", "\[Phi]S1"}], "]"}], " ", 
        "Sin\[Theta]JS1"}], 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Pi]", "/", "2"}], ")"}], "+", "\[Phi]S1"}], "]"}]}], 
        " ", "Sin\[Theta]JS1"}], "Cos\[Theta]JS1"}
     }], ")"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.8613474432595396`*^9, 3.8613474441375523`*^9}, {
  3.861347485478527*^9, 3.8613476421327243`*^9}, {3.8613477351864023`*^9, 
  3.861347735574712*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"1a59b006-ebfd-4966-aeff-2a908bd75287"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Phi]S1", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Phi]S1", "]"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{"Q1", "-", "Q2"}], ")"}]}], "+", 
          RowBox[{"S1n", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Q1", " ", "S1n"}], "-", 
             RowBox[{"Q2", " ", 
              RowBox[{"(", 
               RowBox[{"S1n", "+", 
                RowBox[{"S2n", " ", "\[CapitalSigma]1"}]}], ")"}]}]}], 
            ")"}]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]S1", "]"}]}], 
       RowBox[{"Jn", " ", 
        RowBox[{"(", 
         RowBox[{"Q1", "-", "Q2"}], ")"}], " ", "S1n"}]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", " ", "Q1", " ", 
           RowBox[{"(", 
            RowBox[{"Q1", "-", "Q2"}], ")"}]}], "+", 
          RowBox[{"S1n", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Q1", " ", "S1n"}], "-", 
             RowBox[{"Q2", " ", 
              RowBox[{"(", 
               RowBox[{"S1n", "+", 
                RowBox[{"S2n", " ", "\[CapitalSigma]1"}]}], ")"}]}]}], 
            ")"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]S1", "]"}]}], 
       RowBox[{"Jn", " ", 
        RowBox[{"(", 
         RowBox[{"Q1", "-", "Q2"}], ")"}], " ", "S1n"}]]}], ",", 
     SqrtBox[
      RowBox[{"1", "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"f", " ", "Q1", " ", 
            RowBox[{"(", 
             RowBox[{"Q1", "-", "Q2"}], ")"}]}], "+", 
           RowBox[{"S1n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Q1", " ", "S1n"}], "-", 
              RowBox[{"Q2", " ", 
               RowBox[{"(", 
                RowBox[{"S1n", "+", 
                 RowBox[{"S2n", " ", "\[CapitalSigma]1"}]}], ")"}]}]}], 
             ")"}]}]}], ")"}], "2"], 
        RowBox[{
         SuperscriptBox["Jn", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Q1", "-", "Q2"}], ")"}], "2"], " ", 
         SuperscriptBox["S1n", "2"]}]]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SqrtBox[
       RowBox[{"1", "-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"f", " ", "Q1", " ", 
             RowBox[{"(", 
              RowBox[{"Q1", "-", "Q2"}], ")"}]}], "+", 
            RowBox[{"S1n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Q1", " ", "S1n"}], "-", 
               RowBox[{"Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"S1n", "+", 
                  RowBox[{"S2n", " ", "\[CapitalSigma]1"}]}], ")"}]}]}], 
              ")"}]}]}], ")"}], "2"], 
         RowBox[{
          SuperscriptBox["Jn", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Q1", "-", "Q2"}], ")"}], "2"], " ", 
          SuperscriptBox["S1n", "2"]}]]}]], " ", 
      RowBox[{"Cos", "[", "\[Phi]S1", "]"}]}], ",", 
     RowBox[{
      SqrtBox[
       RowBox[{"1", "-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"f", " ", "Q1", " ", 
             RowBox[{"(", 
              RowBox[{"Q1", "-", "Q2"}], ")"}]}], "+", 
            RowBox[{"S1n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Q1", " ", "S1n"}], "-", 
               RowBox[{"Q2", " ", 
                RowBox[{"(", 
                 RowBox[{"S1n", "+", 
                  RowBox[{"S2n", " ", "\[CapitalSigma]1"}]}], ")"}]}]}], 
              ")"}]}]}], ")"}], "2"], 
         RowBox[{
          SuperscriptBox["Jn", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"Q1", "-", "Q2"}], ")"}], "2"], " ", 
          SuperscriptBox["S1n", "2"]}]]}]], " ", 
      RowBox[{"Sin", "[", "\[Phi]S1", "]"}]}], ",", 
     FractionBox[
      RowBox[{
       FractionBox[
        RowBox[{"f", " ", "Q1"}], "S1n"], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"Q1", " ", "S1n"}], "-", 
         RowBox[{"Q2", " ", 
          RowBox[{"(", 
           RowBox[{"S1n", "+", 
            RowBox[{"S2n", " ", "\[CapitalSigma]1"}]}], ")"}]}]}], 
        RowBox[{"Q1", "-", "Q2"}]]}], "Jn"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8613476866377954`*^9, 3.8613483340519614`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"1a60b8e8-6415-4d87-8681-d5a9514dbdff"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"R1final", "=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Inverse", "[", "EmatS1", "]"}], ".", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"R1", " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}]},
        {
         RowBox[{"R1", " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}]},
        {"0"}
       }], ")"}]}], "]"}], "//", "Simplify", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"in", " ", "inertial", " ", "frame"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8613477419264884`*^9, 3.8613477663446054`*^9}, {
  3.861348074485566*^9, 
  3.8613480777141876`*^9}},ExpressionUUID->"8ca52613-02b3-4bd1-9ab7-\
17f6e59c6df3"]
}, Open  ]]
},
WindowSize->{949, 461},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f3534b86-b941-4496-8ef5-78e75aa8ef8e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 196, 3, 28, "Input",ExpressionUUID->"1224f43d-f341-450d-944d-7104ab01559d"],
Cell[CellGroupData[{
Cell[779, 27, 148, 2, 98, "Title",ExpressionUUID->"666f8abb-1bf2-48ee-b7f0-4e4d61ef635b"],
Cell[CellGroupData[{
Cell[952, 33, 5703, 165, 357, "Input",ExpressionUUID->"dfb3cfcf-801d-462b-b592-fe81aeb90dcb"],
Cell[6658, 200, 3615, 105, 142, "Output",ExpressionUUID->"0377119f-ef47-4d11-8b28-c2fb2422b4a6"],
Cell[10276, 307, 4085, 121, 187, "Output",ExpressionUUID->"c3665678-b589-4273-a542-f3709bf9f711"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14410, 434, 168, 3, 98, "Title",ExpressionUUID->"88ad98b6-6c39-42f7-a5c2-6fdd1c9f8629"],
Cell[14581, 439, 201, 3, 28, "Input",ExpressionUUID->"424afda7-fd38-460b-9d2b-b5db26624aff"],
Cell[CellGroupData[{
Cell[14807, 446, 3699, 111, 286, "Input",ExpressionUUID->"bf9bce0d-9d7e-409d-8531-a06ad0e7afe1"],
Cell[18509, 559, 4121, 115, 217, "Output",ExpressionUUID->"9ec95b93-5a98-4358-a260-eee26ca6c0ca"]
}, Open  ]],
Cell[22645, 677, 635, 19, 61, "Input",ExpressionUUID->"0260daec-be3b-42ad-be55-42b8cb44c77e"],
Cell[23283, 698, 200, 3, 28, "Input",ExpressionUUID->"5dd77733-b920-41fa-8169-30e41777423a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23520, 706, 155, 3, 98, "Title",ExpressionUUID->"62d2531a-e898-4343-9ff0-bc45b3aa99a6"],
Cell[CellGroupData[{
Cell[23700, 713, 5497, 154, 437, "Input",ExpressionUUID->"f1801e3f-966e-4b66-8d7c-2561136acd6a"],
Cell[29200, 869, 3645, 105, 175, "Output",ExpressionUUID->"724c2f64-7c89-4b98-b73b-dc0ef5302e95"],
Cell[32848, 976, 3628, 106, 198, "Output",ExpressionUUID->"3acc4829-3626-429d-8f1d-e8402f0459a9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36525, 1088, 188, 3, 98, "Title",ExpressionUUID->"05a91ee6-d03f-4adf-9000-4f15e9b89d31"],
Cell[CellGroupData[{
Cell[36738, 1095, 3496, 109, 263, "Input",ExpressionUUID->"1a59b006-ebfd-4966-aeff-2a908bd75287"],
Cell[40237, 1206, 4830, 143, 208, "Output",ExpressionUUID->"1a60b8e8-6415-4d87-8681-d5a9514dbdff"]
}, Open  ]],
Cell[45082, 1352, 691, 20, 61, "Input",ExpressionUUID->"8ca52613-02b3-4bd1-9ab7-17f6e59c6df3"]
}, Open  ]]
}
]
*)

